<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‰∫¨ÈÉΩÊóÖË°å„ÅÆ„Åó„Åä„Çä 2026.3.14-3.16</title>
<meta name="robots" content="noindex, nofollow">
<meta name="description" content="2026Âπ¥3Êúà14Êó•„Äú16Êó•„ÅÆ‰∫¨ÈÉΩÊóÖË°å„Åó„Åä„Çä„ÄÇÊù±Á¶èÂØ∫„ÉªÂÆáÊ≤ª„Éª‰ºèË¶ãÁ®≤Ëç∑„ÉªÈáëÈñ£ÂØ∫„ÉªÈäÄÈñ£ÂØ∫„ÉªÊ∏ÖÊ∞¥ÂØ∫„ÉªÂµêÂ±±„Çí„ÇÅ„Åê„Çã2Ê≥ä3Êó•„ÅÆÊóÖÁ®ãË°®„ÄÇ">
<meta property="og:title" content="‰∫¨ÈÉΩÊóÖË°å„ÅÆ„Åó„Åä„Çä 2026.3.14-3.16">
<meta property="og:description" content="Êù±Á¶èÂØ∫„ÉªÂÆáÊ≤ª„Éª‰ºèË¶ãÁ®≤Ëç∑„ÉªÈáëÈñ£ÂØ∫„ÉªÈäÄÈñ£ÂØ∫„ÉªÊ∏ÖÊ∞¥ÂØ∫„ÉªÂµêÂ±±„Çí„ÇÅ„Åê„Çã2Ê≥ä3Êó•„ÅÆÊóÖÁ®ã">
<meta property="og:type" content="website">
<meta property="og:locale" content="ja_JP">
<meta name="theme-color" content="#2C2420">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="‰∫¨ÈÉΩÊóÖË°å">
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 100 100%27><text y=%27.9em%27 font-size=%2790%27>üå∏</text></svg>">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New:wght@400;500;700&family=Zen+Old+Mincho:wght@400;700&family=Caveat:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{--sakura:#F2A7B3;--sakura-light:#FDF0F2;--sakura-deep:#D4748A;--ink:#2C2420;--ink-light:#6B5E57;--ink-faint:#8A7D76;--warm-white:#FBF8F5;--warm-cream:#F5F0EA;--gold:#C4A265;--gold-light:#E8D5B0;--transport:#4A90A4;--food:#D4874D;--sight:#7B8F4E;--hotel:#8B6BAE;--shop:#C4785C;--card-bg:#fff;--shadow-sm:0 1px 3px rgba(44,36,32,.08);--shadow-md:0 4px 16px rgba(44,36,32,.1);--shadow-lg:0 8px 32px rgba(44,36,32,.12);--radius:12px;--now-glow:rgba(242,167,179,.25);--tl-left:28px;--tl-dot-left:24px;--tl-content-left:72px;--tl-time-width:40px}
[data-theme="dark"]{--ink:#E8E0D8;--ink-light:#B0A69E;--ink-faint:#8A8078;--warm-white:#1A1614;--warm-cream:#222018;--card-bg:#2A2622;--transport:#6AB4CC;--food:#E8A06A;--sight:#A0B870;--hotel:#B090D4;--shop:#D89878;--sakura-light:#3A2228;--shadow-sm:0 1px 3px rgba(0,0,0,.2);--shadow-md:0 4px 16px rgba(0,0,0,.3);--shadow-lg:0 8px 32px rgba(0,0,0,.4);--now-glow:rgba(242,167,179,.15)}
*{margin:0;padding:0;box-sizing:border-box}html{scroll-behavior:smooth;overflow-x:clip}
body{font-family:'Zen Kaku Gothic New',sans-serif;background:var(--warm-white);color:var(--ink);line-height:1.7;-webkit-font-smoothing:antialiased;transition:background .4s,color .4s;overflow-x:clip}
@media(prefers-reduced-motion:reduce){*,*::before,*::after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}.sakura-container{display:none!important}}
*:focus-visible{outline:2px solid var(--sakura);outline-offset:2px;border-radius:4px}
.sakura-container{position:fixed;inset:0;pointer-events:none;z-index:9999;overflow:hidden}
.sakura-petal{position:absolute;top:-20px;opacity:0;animation:sakuraFall linear forwards;pointer-events:none}
.sakura-petal::before{content:'üå∏';font-size:var(--petal-size,14px);display:block;animation:sakuraSway ease-in-out infinite}
@keyframes sakuraFall{0%{opacity:0;transform:translateY(-20px) rotate(0)}10%{opacity:.8}90%{opacity:.6}100%{opacity:0;transform:translateY(105vh) rotate(var(--rotation,360deg))}}
@keyframes sakuraSway{0%,100%{transform:translateX(0) rotate(0)}25%{transform:translateX(var(--sway,30px)) rotate(15deg)}75%{transform:translateX(calc(var(--sway,30px)*-1)) rotate(-15deg)}}
.hero{position:relative;min-height:100vh;display:flex;align-items:center;justify-content:center;overflow:hidden;background:linear-gradient(135deg,#2C2420,#4A3F38 50%,#3D2E28)}
.hero::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 20% 50%,rgba(242,167,179,.15) 0%,transparent 60%),radial-gradient(ellipse at 80% 30%,rgba(196,162,101,.1) 0%,transparent 50%)}
.hero-pattern{position:absolute;inset:0;opacity:.04;background-image:repeating-linear-gradient(0deg,transparent,transparent 40px,rgba(255,255,255,.5) 40px,rgba(255,255,255,.5) 41px),repeating-linear-gradient(90deg,transparent,transparent 40px,rgba(255,255,255,.5) 40px,rgba(255,255,255,.5) 41px)}
.hero-content{position:relative;z-index:1;text-align:center;padding:2rem}
.hero-label{font-family:'Caveat',cursive;color:var(--sakura);font-size:1.3rem;letter-spacing:.15em;margin-bottom:1rem;opacity:0;animation:fadeUp .8s ease-out .3s forwards}
.hero-title{font-family:'Zen Old Mincho',serif;font-size:clamp(3.5rem,10vw,7rem);color:#FBF8F5;letter-spacing:.2em;margin-bottom:.5rem;opacity:0;animation:fadeUp .8s ease-out .5s forwards}
.hero-dates{font-size:1rem;color:var(--gold-light);letter-spacing:.3em;font-weight:400;margin-bottom:2.5rem;opacity:0;animation:fadeUp .8s ease-out .7s forwards}
.hero-divider{width:60px;height:1px;background:var(--sakura);margin:0 auto 2rem;opacity:0;animation:fadeUp .8s ease-out .6s forwards}
.hero-meta{display:flex;gap:2rem;justify-content:center;flex-wrap:wrap;opacity:0;animation:fadeUp .8s ease-out .9s forwards}
.hero-meta-item{color:rgba(251,248,245,.6);font-size:.85rem;letter-spacing:.1em}
.hero-meta-item span{color:rgba(251,248,245,.9);font-weight:500}
.scroll-hint{position:absolute;bottom:2rem;left:50%;transform:translateX(-50%);color:rgba(251,248,245,.3);font-size:.75rem;letter-spacing:.2em;animation:pulse 2s ease-in-out infinite}
.scroll-hint::after{content:'';display:block;width:1px;height:30px;background:rgba(251,248,245,.2);margin:.5rem auto 0;animation:scrollLine 2s ease-in-out infinite}
.day-nav{position:sticky;top:0;z-index:100;background:rgba(251,248,245,.92);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-bottom:1px solid rgba(44,36,32,.06);transition:box-shadow .3s,background .4s}
[data-theme="dark"] .day-nav{background:rgba(26,22,20,.92);border-bottom-color:rgba(255,255,255,.06)}
.day-nav.scrolled{box-shadow:var(--shadow-sm)}
.day-nav-inner{max-width:800px;margin:0 auto;display:flex;align-items:center;padding:0 1rem;overflow:hidden}
.nav-brand{font-family:'Zen Old Mincho',serif;font-size:1rem;color:var(--ink);letter-spacing:.15em;padding:1rem 1rem 1rem 0;border-right:1px solid rgba(128,128,128,.15);white-space:nowrap;cursor:pointer}
.nav-days{display:flex;flex:1;justify-content:center;min-width:0}
.nav-day-btn{background:none;border:none;padding:1rem 1.2rem;font-family:'Zen Kaku Gothic New',sans-serif;font-size:.82rem;color:var(--ink-faint);cursor:pointer;position:relative;transition:color .3s;letter-spacing:.05em}
.nav-day-btn:hover,.nav-day-btn.active{color:var(--ink)}
.nav-day-btn.active::after{content:'';position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:20px;height:2px;background:var(--sakura);border-radius:1px}
.nav-actions{display:flex;gap:.4rem;align-items:center;flex-shrink:0}
.nav-icon-btn{background:none;border:1px solid rgba(128,128,128,.15);width:34px;height:34px;border-radius:50%;cursor:pointer;font-size:.9rem;display:flex;align-items:center;justify-content:center;transition:all .3s;color:var(--ink-light)}
.nav-icon-btn:hover{background:var(--ink);color:var(--warm-white);border-color:var(--ink)}
[data-theme="dark"] .nav-icon-btn:hover{background:var(--warm-cream);color:#1A1614}
.travel-progress{display:none;max-width:800px;margin:0 auto;padding:.4rem 1.5rem}
.travel-progress.active{display:block}
.travel-progress-inner{display:flex;align-items:center;gap:.6rem}
.travel-progress-bar{flex:1;height:3px;background:rgba(128,128,128,.15);border-radius:2px;overflow:hidden}
.travel-progress-fill{height:100%;background:linear-gradient(90deg,var(--sakura),var(--gold));border-radius:2px;transition:width 1s;width:0}
.travel-progress-text{font-size:.68rem;color:var(--ink-faint);white-space:nowrap}
.content-section{max-width:800px;margin:0 auto;padding:0 1.5rem;overflow-x:hidden}
.info-card,.checklist-card,.memo-card,.album-card{background:var(--warm-cream);border-radius:var(--radius);padding:2rem;margin:1rem 0;transition:background .4s}
.info-card{margin-top:3rem}
.memo-card{margin-bottom:2rem}
.info-card-title{font-family:'Zen Old Mincho',serif;font-size:1.05rem;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem}
.omiyage-grid{display:grid;gap:.2rem}
.omiyage-section{margin-bottom:.6rem}
.omiyage-section-title{font-size:.73rem;color:var(--ink-faint);letter-spacing:.06em;margin-bottom:.2rem;padding-bottom:.2rem;border-bottom:1px solid rgba(128,128,128,.1)}
.omiyage-check{display:flex;align-items:center;gap:.6rem;font-size:.85rem;padding:.4rem 0;cursor:pointer;user-select:none;transition:opacity .3s}
.omiyage-check.checked{opacity:.4}
.omiyage-check.checked .omiyage-item-name{text-decoration:line-through}
.omiyage-check-box{width:16px;height:16px;border:2px solid var(--gold);border-radius:3px;flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:all .2s;font-size:.65rem;color:transparent}
.omiyage-check.checked .omiyage-check-box{background:var(--gold);border-color:var(--gold);color:#fff}
.omiyage-item-name{font-weight:500;flex-shrink:0}
.omiyage-item-for{color:var(--ink-faint);font-size:.75rem;margin-left:auto;white-space:nowrap}
.omiyage-progress{margin-top:.8rem;display:flex;align-items:center;gap:.8rem}
.omiyage-progress-bar{flex:1;height:3px;background:rgba(128,128,128,.15);border-radius:2px;overflow:hidden}
.omiyage-progress-fill{height:100%;background:var(--gold);border-radius:2px;transition:width .4s;width:0}
.omiyage-progress-text{font-size:.72rem;color:var(--ink-faint);white-space:nowrap}
.countdown-card{background:linear-gradient(135deg,var(--sakura-light),rgba(196,162,101,.08));border-radius:var(--radius);padding:1.5rem 2rem;margin:1rem 0;text-align:center;transition:background .4s;margin-top:3rem}
.countdown-title{font-size:.82rem;color:var(--ink-faint);letter-spacing:.1em;margin-bottom:.3rem}
.countdown-display{font-family:'Zen Old Mincho',serif;font-size:1.8rem;font-weight:700;color:var(--sakura-deep);letter-spacing:.05em}
.countdown-sub{font-size:.75rem;color:var(--ink-faint);margin-top:.15rem}
.weather-card{background:var(--warm-cream);border-radius:var(--radius);padding:1.5rem 2rem;margin:1rem 0;transition:background .4s}
.weather-days{display:grid;grid-template-columns:repeat(3,1fr);gap:.8rem;margin-top:.8rem}
.weather-day{background:var(--card-bg);border-radius:10px;padding:.8rem;text-align:center;transition:background .4s,box-shadow .3s}
.weather-day:hover{box-shadow:var(--shadow-sm)}
.weather-day-label{font-size:.72rem;color:var(--ink-faint);letter-spacing:.05em;margin-bottom:.3rem;font-weight:500}
.weather-day-icon{font-size:1.8rem;margin:.2rem 0}
.weather-day-temp{font-family:'Zen Old Mincho',serif;font-size:1rem;font-weight:700;color:var(--ink)}
.weather-day-temp-min{font-size:.8rem;color:var(--ink-faint);font-weight:400}
.weather-day-detail{font-size:.7rem;color:var(--ink-light);margin-top:.3rem;line-height:1.5}
.weather-loading{text-align:center;padding:1.5rem;font-size:.82rem;color:var(--ink-faint)}
.weather-error{text-align:center;padding:1rem;font-size:.82rem;color:var(--ink-faint)}
.weather-note{font-size:.68rem;color:var(--ink-faint);margin-top:.6rem;text-align:right}
.weather-current{margin-top:1rem;padding-top:.8rem;border-top:1px dashed rgba(128,128,128,.15)}
.weather-current-title{font-size:.78rem;font-weight:600;color:var(--ink-light);margin-bottom:.5rem;letter-spacing:.05em}
.weather-current-body{display:flex;align-items:center;gap:1rem;background:var(--card-bg);border-radius:10px;padding:.8rem 1rem;transition:background .4s}
.weather-current-icon{font-size:2rem}
.weather-current-temp{font-family:'Zen Old Mincho',serif;font-size:1.4rem;font-weight:700}
.weather-current-detail{font-size:.75rem;color:var(--ink-light);line-height:1.6}
.weather-history{margin-top:.8rem;padding-top:.8rem;border-top:1px dashed rgba(128,128,128,.15)}
.weather-history-title{font-size:.78rem;font-weight:600;color:var(--ink-light);margin-bottom:.5rem;letter-spacing:.05em}
.weather-history-body{display:grid;grid-template-columns:1fr 1fr;gap:.3rem .8rem}
.weather-history-row{display:flex;justify-content:space-between;align-items:center;font-size:.8rem;padding:.3rem .6rem;background:var(--card-bg);border-radius:6px;transition:background .4s}
.weather-history-label{color:var(--ink-faint);font-size:.72rem}
.weather-history-value{font-weight:500;color:var(--ink);font-size:.8rem}
.emergency-card{background:var(--warm-cream);border-radius:var(--radius);padding:1.5rem 2rem;margin:1rem 0;transition:background .4s}
.emergency-grid{display:grid;grid-template-columns:1fr 1fr;gap:.5rem;margin-top:.8rem}
.emergency-item{display:flex;align-items:center;gap:.5rem;font-size:.82rem;padding:.5rem .7rem;background:var(--card-bg);border-radius:8px;transition:background .4s}
.emergency-icon{font-size:1rem;flex-shrink:0}
.emergency-info{display:flex;flex-direction:column}
.emergency-label{font-size:.7rem;color:var(--ink-faint)}
.emergency-value{font-weight:500;color:var(--ink);font-size:.8rem}
.emergency-tel{display:inline-block;font-size:.7rem;color:var(--transport);text-decoration:none;margin-top:.2rem;font-weight:500}
.emergency-tel:hover{text-decoration:underline}
.station-card{background:var(--warm-cream);border-radius:var(--radius);padding:1.5rem 2rem;margin:1rem 0;transition:background .4s}
.station-card-desc{font-size:.78rem;color:var(--ink-faint);margin-bottom:.8rem;line-height:1.6}
.station-grid{display:grid;grid-template-columns:1fr 1fr;gap:.5rem}
.station-item{background:var(--card-bg);border-radius:8px;padding:.6rem .8rem;transition:background .4s,box-shadow .3s}
.station-item:hover{box-shadow:var(--shadow-sm)}
.station-name{font-size:.8rem;font-weight:600;color:var(--ink);margin-bottom:.3rem}
.station-links{display:flex;flex-wrap:wrap;gap:.3rem;overflow:hidden}
.station-link{display:inline-flex;align-items:center;gap:.2rem;font-size:.68rem;color:var(--transport);text-decoration:none;padding:.15rem .4rem;border:1px solid rgba(74,144,164,.2);border-radius:4px;transition:all .2s;white-space:nowrap}
.station-link:hover{background:var(--transport);color:#fff;border-color:var(--transport)}
.card-photo-wrap{position:relative;width:100%;height:140px;border-radius:8px;margin-top:.6rem;overflow:hidden;background:linear-gradient(135deg,var(--warm-cream),rgba(128,128,128,.08));transition:background .4s}
.card-photo{width:100%;height:100%;object-fit:cover;opacity:0;transition:opacity .6s,filter .4s}
.card-photo.loaded{opacity:1}

.card-photo-placeholder{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:2rem;opacity:.3}
.checklist-columns{display:grid;grid-template-columns:1fr 1fr;gap:.3rem 2rem}
.check-item{display:flex;align-items:center;gap:.6rem;padding:.35rem 0;font-size:.85rem;cursor:pointer;user-select:none;transition:opacity .3s}
.check-item.checked{opacity:.45;text-decoration:line-through}
.check-box{width:18px;height:18px;border:2px solid var(--ink-faint);border-radius:4px;flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:all .2s;font-size:.7rem;color:transparent}
.check-item.checked .check-box{background:var(--sakura);border-color:var(--sakura);color:#fff}
.checklist-progress{margin-top:1rem;display:flex;align-items:center;gap:.8rem}
.progress-bar{flex:1;height:4px;background:rgba(128,128,128,.15);border-radius:2px;overflow:hidden}
.progress-fill{height:100%;background:var(--sakura);border-radius:2px;transition:width .4s;width:0}
.progress-text{font-size:.75rem;color:var(--ink-faint);white-space:nowrap}
.add-item-row{display:flex;gap:.5rem;margin-top:.6rem}
.add-item-input{flex:1;min-width:0;border:1px dashed rgba(128,128,128,.25);border-radius:6px;padding:.4rem .7rem;font-family:'Zen Kaku Gothic New',sans-serif;font-size:.82rem;background:var(--card-bg);color:var(--ink);outline:none;transition:border-color .3s}
.add-item-input:focus{border-color:var(--sakura);outline:2px solid rgba(242,167,179,.3);outline-offset:1px}
.add-item-input::placeholder{color:var(--ink-faint)}
.add-item-btn{flex-shrink:0;background:var(--sakura);color:#fff;border:none;border-radius:6px;padding:.4rem .8rem;font-size:.8rem;cursor:pointer;font-family:'Zen Kaku Gothic New',sans-serif;transition:opacity .2s;white-space:nowrap}
.add-item-btn:hover{opacity:.85}
.memo-textarea{width:100%;min-height:80px;border:1px dashed rgba(128,128,128,.25);border-radius:8px;padding:.8rem 1rem;font-family:'Zen Kaku Gothic New',sans-serif;font-size:.85rem;line-height:1.8;background:var(--card-bg);color:var(--ink);resize:vertical;transition:border-color .3s,background .4s}
.memo-textarea:focus{border-color:var(--sakura);outline:2px solid rgba(242,167,179,.3);outline-offset:1px}
.memo-saved{font-size:.72rem;color:var(--ink-faint);margin-top:.4rem;text-align:right;opacity:0;transition:opacity .3s}
.memo-saved.show{opacity:1}
.memo-tabs{display:flex;gap:.3rem;margin-bottom:.8rem}
.memo-tab{background:none;border:1px solid rgba(128,128,128,.15);padding:.3rem .8rem;border-radius:6px;font-size:.75rem;font-family:'Zen Kaku Gothic New',sans-serif;color:var(--ink-faint);cursor:pointer;transition:all .2s}
.memo-tab.active{background:var(--sakura);color:#fff;border-color:var(--sakura)}
.album-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:.5rem;margin-top:.8rem}
.album-slot{aspect-ratio:1;border:2px dashed rgba(128,128,128,.2);border-radius:8px;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .3s;overflow:hidden;position:relative}
.album-slot:hover{border-color:var(--sakura);background:rgba(242,167,179,.05)}
.album-slot-icon{font-size:1.5rem;opacity:.3}
.album-slot-text{font-size:.68rem;color:var(--ink-faint);margin-top:.3rem}
.album-slot img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;border-radius:6px}
.album-slot .album-remove{position:absolute;top:4px;right:4px;width:22px;height:22px;background:rgba(0,0,0,.6);color:#fff;border:none;border-radius:50%;font-size:.7rem;cursor:pointer;display:none;align-items:center;justify-content:center;z-index:2}
.album-slot:hover .album-remove{display:flex}
.album-slot input[type="file"]{display:none}
.day-header{padding:3rem 0 2rem;text-align:center;position:relative}
.day-header::before{content:'';display:block;width:40px;height:1px;background:var(--gold);margin:0 auto 1.5rem}
.day-number{font-family:'Caveat',cursive;color:var(--sakura);font-size:1.1rem;letter-spacing:.15em;margin-bottom:.3rem}
.day-date{font-family:'Zen Old Mincho',serif;font-size:2rem;letter-spacing:.1em}
.day-weekday{font-size:.85rem;color:var(--ink-faint);margin-top:.3rem}
.day-subtotal{text-align:center;padding:1.5rem 0 .5rem;margin-top:.5rem}
.day-subtotal-inner{display:inline-flex;align-items:center;gap:.6rem;background:var(--warm-cream);padding:.6rem 1.4rem;border-radius:20px;font-size:.82rem;color:var(--ink-light);transition:background .4s}
.day-subtotal-amount{font-weight:700;color:var(--sakura-deep);font-size:.95rem}
.day-map-link{text-align:center;margin-top:.5rem;overflow:hidden}
.day-map-link a{display:inline-flex;align-items:center;gap:.3rem;font-size:.78rem;color:var(--transport);text-decoration:none;padding:.4rem 1rem;border:1px solid rgba(74,144,164,.25);border-radius:20px;transition:all .2s}
.day-map-link a:hover{background:var(--transport);color:#fff;border-color:var(--transport)}
.timeline{position:relative}
.timeline::before{content:'';position:absolute;left:var(--tl-left);top:0;bottom:0;width:1px;background:linear-gradient(to bottom,transparent,rgba(128,128,128,.15) 5%,rgba(128,128,128,.15) 95%,transparent)}
.duration-badge{position:relative;padding-left:var(--tl-content-left);padding-bottom:.2rem;padding-top:.2rem}
.duration-badge-inner{display:inline-flex;align-items:center;gap:.3rem;font-size:.7rem;color:var(--ink-faint);background:var(--warm-cream);padding:.15rem .6rem;border-radius:10px;transition:background .4s}
.timeline-item{position:relative;padding-left:var(--tl-content-left);padding-bottom:1rem;opacity:0;transform:translateY(20px);transition:all .6s cubic-bezier(.22,1,.36,1)}
.timeline-item.visible{opacity:1;transform:translateY(0)}
.timeline-item.now-here .timeline-card{box-shadow:0 0 0 2px var(--sakura),0 0 20px var(--now-glow)}
.now-label{display:none;position:absolute;right:0;top:.2rem;font-size:.65rem;font-weight:700;color:var(--sakura-deep);background:var(--sakura-light);padding:.15rem .5rem;border-radius:4px;letter-spacing:.1em;animation:nowPulse 2s ease-in-out infinite}
.timeline-item.now-here .now-label{display:block}
@keyframes nowPulse{0%,100%{opacity:1}50%{opacity:.5}}
.timeline-time{position:absolute;left:0;top:.3rem;font-size:.78rem;font-weight:500;color:var(--ink-faint);letter-spacing:.03em;width:var(--tl-time-width);text-align:right}
.timeline-dot{position:absolute;left:var(--tl-dot-left);top:.45rem;width:9px;height:9px;border-radius:50%;border:2px solid;background:var(--warm-white);z-index:1;transition:background .4s}
.timeline-dot.transport{border-color:var(--transport)}.timeline-dot.food{border-color:var(--food)}.timeline-dot.sight{border-color:var(--sight)}.timeline-dot.hotel{border-color:var(--hotel)}.timeline-dot.shop{border-color:var(--shop)}
.timeline-card{background:var(--card-bg);border-radius:var(--radius);padding:1.1rem 1.3rem;box-shadow:var(--shadow-sm);transition:box-shadow .3s,transform .3s,background .4s;position:relative;overflow:hidden}
.timeline-card:hover{box-shadow:var(--shadow-md);transform:translateY(-1px)}
.timeline-card::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px}
.timeline-card.transport::before{background:var(--transport)}.timeline-card.food::before{background:var(--food)}.timeline-card.sight::before{background:var(--sight)}.timeline-card.hotel::before{background:var(--hotel)}.timeline-card.shop::before{background:var(--shop)}
.card-header{display:flex;align-items:flex-start;justify-content:space-between;gap:.8rem;margin-bottom:.2rem}
.card-category{font-size:.65rem;letter-spacing:.1em;font-weight:500;padding:.12rem .45rem;border-radius:3px;white-space:nowrap;flex-shrink:0}
.card-category.transport{color:var(--transport);background:rgba(74,144,164,.1)}.card-category.food{color:var(--food);background:rgba(212,135,77,.1)}.card-category.sight{color:var(--sight);background:rgba(123,143,78,.1)}.card-category.hotel{color:var(--hotel);background:rgba(139,107,174,.1)}.card-category.shop{color:var(--shop);background:rgba(196,120,92,.1)}
.card-title{font-family:'Zen Old Mincho',serif;font-size:1rem;font-weight:700;line-height:1.5}
.card-detail{font-size:.8rem;color:var(--ink-light);line-height:1.8;margin-top:.2rem}
.card-bottom{display:flex;align-items:center;flex-wrap:wrap;gap:.5rem;margin-top:.5rem}
.card-cost{display:inline-flex;align-items:center;gap:.3rem;font-size:.78rem;color:var(--gold);font-weight:500;background:rgba(196,162,101,.08);padding:.15rem .5rem;border-radius:4px}
.card-reserved{display:inline-flex;align-items:center;font-size:.68rem;color:var(--sakura-deep);background:var(--sakura-light);padding:.12rem .45rem;border-radius:3px}
.card-link{display:inline-flex;align-items:center;gap:.25rem;font-size:.72rem;color:var(--transport);text-decoration:none;padding:.15rem .5rem;border:1px solid rgba(74,144,164,.25);border-radius:4px;transition:all .2s}
.card-link:hover{background:var(--transport);color:#fff;border-color:var(--transport)}
.card-link.site-link{color:var(--food);border-color:rgba(212,135,77,.25)}
.card-link.site-link:hover{background:var(--food);color:#fff;border-color:var(--food)}
.modal-overlay{position:fixed;inset:0;background:rgba(44,36,32,.5);backdrop-filter:blur(8px);z-index:200;display:none;align-items:center;justify-content:center;padding:1.5rem;opacity:0;transition:opacity .3s}
.modal-overlay.open{display:flex;opacity:1}
.modal{background:var(--warm-white);border-radius:16px;max-width:520px;width:100%;max-height:80vh;overflow-y:auto;padding:2rem;box-shadow:var(--shadow-lg);transition:background .4s}
.modal-title{font-family:'Zen Old Mincho',serif;font-size:1.2rem;margin-bottom:1.2rem;display:flex;align-items:center;justify-content:space-between}
.modal-close{background:none;border:none;font-size:1.5rem;color:var(--ink-faint);cursor:pointer;padding:.3rem;line-height:1}
.modal-close-bottom{display:block;width:100%;margin-top:1.2rem;padding:.7rem;background:var(--warm-cream);border:none;border-radius:8px;font-family:'Zen Kaku Gothic New',sans-serif;font-size:.85rem;color:var(--ink-light);cursor:pointer;transition:background .2s}
.modal-close-bottom:hover{background:var(--sakura-light)}
.cost-day-title{font-size:.82rem;font-weight:700;margin:1rem 0 .4rem;padding-bottom:.3rem;border-bottom:1px solid rgba(128,128,128,.12)}
.cost-row{display:flex;justify-content:space-between;align-items:baseline;font-size:.8rem;padding:.3rem 0;color:var(--ink-light)}
.cost-row-amount{font-weight:500;color:var(--ink);text-align:right;min-width:70px}
.cost-day-sub{display:flex;justify-content:space-between;font-size:.8rem;padding:.5rem 0 0;margin-top:.3rem;border-top:1px dashed rgba(128,128,128,.15);font-weight:600;color:var(--ink-light)}
.cost-total{display:flex;justify-content:space-between;align-items:baseline;margin-top:1.2rem;padding-top:.8rem;border-top:2px solid var(--ink);font-family:'Zen Old Mincho',serif}
.cost-total-label{font-size:1rem;font-weight:700}
.cost-total-amount{font-size:1.3rem;font-weight:700;color:var(--sakura-deep)}
.cost-note{font-size:.72rem;color:var(--ink-faint);margin-top:.6rem;text-align:right}
.qr-modal-content{text-align:center;padding:1rem 0}
.qr-url{font-size:.72rem;color:var(--ink-faint);word-break:break-all;margin-top:.5rem;padding:0 1rem}
.qr-copy-btn{margin-top:.8rem;padding:.5rem 1.5rem;background:var(--sakura);color:#fff;border:none;border-radius:8px;font-family:'Zen Kaku Gothic New',sans-serif;font-size:.82rem;cursor:pointer;transition:opacity .2s}
.qr-copy-btn:hover{opacity:.85}
.back-to-top{position:fixed;bottom:1.5rem;right:1.5rem;width:42px;height:42px;background:var(--ink);color:var(--warm-white);border:none;border-radius:50%;font-size:1.1rem;cursor:pointer;z-index:90;opacity:0;transform:translateY(10px);transition:all .3s;display:flex;align-items:center;justify-content:center;box-shadow:var(--shadow-md)}
.back-to-top.visible{opacity:1;transform:translateY(0)}
.back-to-top:hover{background:var(--sakura)}
[data-theme="dark"] .back-to-top{background:var(--warm-cream);color:#1A1614}
.help-btn{font-family:'Zen Old Mincho',serif;font-weight:700;font-size:.85rem!important}
.help-modal-body{padding:.5rem 0;font-size:.85rem;line-height:1.85;color:var(--ink)}
.help-modal-body h2{font-family:'Zen Old Mincho',serif;font-size:1rem;font-weight:700;margin:1.8rem 0 .6rem;padding-bottom:.4rem;border-bottom:1px solid rgba(128,128,128,.15);color:var(--ink)}
.help-modal-body h2:first-child{margin-top:.5rem}
.help-modal-body h3{font-size:.88rem;font-weight:700;margin:1.2rem 0 .4rem;color:var(--ink)}
.help-modal-body p{margin:.4rem 0;font-size:.83rem;color:var(--ink-light)}
.help-modal-body ul{margin:.4rem 0 .4rem 1.2rem;font-size:.83rem;color:var(--ink-light)}
.help-modal-body li{margin:.25rem 0}
.help-modal-body strong{color:var(--ink);font-weight:600}
.help-modal-body hr{border:none;border-top:1px solid rgba(128,128,128,.12);margin:1.5rem 0}
.help-modal-body .help-table{width:100%;border-collapse:collapse;margin:.6rem 0;font-size:.8rem}
.help-modal-body .help-table th,.help-modal-body .help-table td{padding:.45rem .6rem;text-align:left;border-bottom:1px solid rgba(128,128,128,.1)}
.help-modal-body .help-table th{font-weight:600;color:var(--ink);background:var(--warm-cream);font-size:.75rem;letter-spacing:.03em}
.help-modal-body .help-table td:first-child{white-space:nowrap;font-weight:500}
.help-modal-body .help-note{background:var(--warm-cream);border-radius:8px;padding:.8rem 1rem;margin:.8rem 0;font-size:.78rem;color:var(--ink-light);line-height:1.7}
#helpModal .modal{padding-top:0}
.help-modal-header{position:sticky;top:0;z-index:2;background:var(--warm-white);padding:1.5rem 0 .8rem;border-bottom:1px solid rgba(128,128,128,.12);margin-bottom:.5rem;transition:background .4s}
[data-theme="dark"] .help-modal-header{background:var(--warm-white)}
.footer{text-align:center;padding:4rem 1.5rem;background:var(--warm-cream);transition:background .4s}
.footer-title{font-family:'Zen Old Mincho',serif;font-size:1.3rem;letter-spacing:.15em;margin-bottom:.5rem}
.footer-sub{font-size:.85rem;color:var(--ink-faint);letter-spacing:.1em}
.footer-sakura{margin-top:2rem;font-size:1.5rem;opacity:.4}
.seat-chart{background:var(--warm-cream);border-radius:var(--radius);padding:1.2rem;margin-top:.6rem;transition:background .4s}
.seat-chart-title{font-size:.82rem;font-weight:600;color:var(--ink);margin-bottom:.8rem;display:flex;align-items:center;gap:.4rem}
.seat-train-cars{display:flex;gap:0;margin-bottom:1rem;overflow-x:auto;padding-bottom:.4rem;-webkit-overflow-scrolling:touch}
.seat-train-car{min-width:28px;height:26px;border:1px solid rgba(128,128,128,.25);display:flex;align-items:center;justify-content:center;font-size:.65rem;color:var(--ink-faint);background:var(--card-bg);transition:background .4s,color .3s}
.seat-train-car:first-child{border-radius:12px 0 0 12px}
.seat-train-car:last-child{border-radius:0 12px 12px 0}
.seat-train-car.green{background:rgba(123,143,78,.15);color:var(--sight);border-color:rgba(123,143,78,.3)}
.seat-train-car.ours{background:var(--sakura-light);color:var(--sakura-deep);border-color:var(--sakura);font-weight:700}
.seat-train-dir{display:flex;justify-content:space-between;font-size:.68rem;color:var(--ink-faint);margin-bottom:.3rem}
.seat-layout{margin-top:.6rem}
.seat-layout-title{font-size:.75rem;color:var(--ink-light);text-align:center;margin-bottom:.5rem;font-weight:500}
.seat-layout-dir{font-size:.68rem;color:var(--ink-faint);text-align:center;margin:.3rem 0}
.seat-row{display:flex;align-items:center;justify-content:center;gap:0;margin:.3rem 0}
.seat-row-num{width:18px;font-size:.7rem;color:var(--ink-faint);text-align:center;flex-shrink:0}
.seat-cell{width:32px;height:28px;border:1px solid rgba(128,128,128,.2);display:flex;align-items:center;justify-content:center;font-size:.68rem;color:var(--ink-faint);background:var(--card-bg);margin:0 1px;border-radius:4px;transition:background .4s}
.seat-cell.ours{background:var(--sakura-light);color:var(--sakura-deep);border-color:var(--sakura);font-weight:600}
.seat-aisle{width:12px}
.seat-col-header{display:flex;align-items:center;justify-content:center;gap:0;margin-bottom:.2rem}
.seat-col-label{width:32px;text-align:center;font-size:.68rem;font-weight:600;color:var(--ink-light);margin:0 1px}
.seat-col-aisle{width:12px}
.seat-col-num-spacer{width:18px}
.seat-legend{display:flex;gap:1rem;margin-top:.8rem;justify-content:center;flex-wrap:wrap}
.seat-legend-item{display:flex;align-items:center;gap:.3rem;font-size:.68rem;color:var(--ink-faint)}
.seat-legend-box{width:14px;height:14px;border-radius:3px;border:1px solid}
.seat-legend-box.ours{background:var(--sakura-light);border-color:var(--sakura)}
.seat-legend-box.green{background:rgba(123,143,78,.15);border-color:rgba(123,143,78,.3)}
.seat-legend-box.free{background:var(--card-bg);border-color:rgba(128,128,128,.25);position:relative}
.seat-legend-box.free::after{content:'„Äú';position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:.55rem;color:var(--ink-faint)}
@keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes pulse{0%,100%{opacity:.3}50%{opacity:.6}}
@keyframes scrollLine{0%{transform:scaleY(0);transform-origin:top}50%{transform:scaleY(1);transform-origin:top}51%{transform:scaleY(1);transform-origin:bottom}100%{transform:scaleY(0);transform-origin:bottom}}
@media(max-width:640px){:root{--tl-left:20px;--tl-dot-left:16px;--tl-content-left:52px;--tl-time-width:32px}.nav-brand{display:none}.nav-day-btn{padding:.9rem .7rem;font-size:.78rem}.nav-actions{gap:.25rem}.nav-icon-btn{width:30px;height:30px;font-size:.8rem}.day-date{font-size:1.6rem}.timeline-time{font-size:.7rem}.timeline-card{padding:.9rem 1rem}.card-title{font-size:.92rem}.card-detail{word-break:break-word}.info-card,.checklist-card,.memo-card,.weather-card,.emergency-card,.countdown-card,.station-card,.album-card{padding:1.5rem}.checklist-columns{grid-template-columns:1fr}.modal{padding:1.5rem}.hero-meta{gap:1rem}.weather-days{gap:.5rem}.emergency-grid{grid-template-columns:1fr}.card-photo-wrap{height:110px}.weather-history-body{grid-template-columns:1fr}.station-grid{grid-template-columns:1fr}.album-grid{gap:.4rem}.add-item-btn{flex-shrink:0;padding:.4rem .6rem;font-size:.75rem}}
@media print{.day-nav,.scroll-hint,.sakura-container,.memo-card,.modal-overlay,.checklist-card,.countdown-card,.weather-card,.emergency-card,.station-card,.back-to-top,.travel-progress,.album-card,.help-btn{display:none!important}.hero{min-height:auto;padding:3rem 2rem;page-break-after:always}.timeline-item{opacity:1!important;transform:none!important}.timeline-card{box-shadow:none;border:1px solid #e0d8d0}.timeline-card:hover{transform:none}body{background:#fff}}
/* === Card Review UI === */
.card-review{margin-top:.5rem;border-top:1px dashed rgba(128,128,128,.12);padding-top:.5rem}
.card-review-row{display:flex;align-items:center;gap:.3rem}
.card-review-stars{display:flex;gap:0}
.card-review-star{background:none;border:none;font-size:1.05rem;cursor:pointer;padding:1px 2px;color:rgba(128,128,128,.2);transition:color .15s,transform .15s;line-height:1}
.card-review-star:hover{transform:scale(1.2)}
.card-review-star.filled{color:var(--gold)}
.card-review-input{width:100%;border:none;border-bottom:1px dashed rgba(128,128,128,.15);background:transparent;font-family:'Zen Kaku Gothic New',sans-serif;font-size:.78rem;color:var(--ink);padding:.35rem 0;margin-top:.3rem;outline:none;transition:border-color .3s}
.card-review-input:focus{border-color:var(--sakura)}
.card-review-input::placeholder{color:var(--ink-faint);font-style:italic;font-size:.72rem}
.card-review-saved{font-size:.58rem;color:var(--sakura);opacity:0;transition:opacity .3s;margin-left:auto;white-space:nowrap}
.card-review-saved.show{opacity:1}
.card-review-label{font-size:.65rem;color:var(--ink-faint);letter-spacing:.05em}
/* Photo add overlay */
.card-photo-add{position:absolute;bottom:6px;right:6px;width:30px;height:30px;background:rgba(0,0,0,.45);backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px);border:1.5px solid rgba(255,255,255,.2);border-radius:50%;color:#fff;font-size:.75rem;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:3;transition:all .2s;opacity:.7}
.card-photo-add:hover{opacity:1;transform:scale(1.1);background:rgba(0,0,0,.65)}
.card-photo-add input[type="file"]{display:none}
.card-photo-user{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;z-index:2;border-radius:8px}
.card-photo-remove{position:absolute;top:6px;right:6px;width:22px;height:22px;background:rgba(0,0,0,.6);color:#fff;border:none;border-radius:50%;font-size:.6rem;cursor:pointer;z-index:4;display:none;align-items:center;justify-content:center}
.card-photo-wrap:hover .card-photo-remove.has-photo{display:flex}
/* Cards without photo - add a mini slot */
.card-photo-mini{position:relative;width:100%;height:60px;border-radius:8px;margin-top:.5rem;overflow:hidden;border:1.5px dashed rgba(128,128,128,.15);display:flex;align-items:center;justify-content:center;gap:.4rem;cursor:pointer;transition:all .2s;background:var(--warm-cream)}
.card-photo-mini:hover{border-color:var(--sakura);background:rgba(242,167,179,.04)}
.card-photo-mini-icon{font-size:.85rem;opacity:.35}
.card-photo-mini-text{font-size:.65rem;color:var(--ink-faint)}
.card-photo-mini input[type="file"]{display:none}
.card-photo-mini img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;border-radius:6px}
.card-photo-mini .card-photo-remove{top:3px;right:3px;width:18px;height:18px;font-size:.55rem}
.card-photo-mini:hover .card-photo-remove.has-photo{display:flex}
/* Story lock */
.story-play-btn.locked{opacity:.45!important;background:rgba(128,128,128,.25)!important;border-color:rgba(128,128,128,.15)!important;cursor:default!important}
.story-play-btn.locked:hover{transform:none!important}
/* Toast notification */
.story-toast{position:fixed;bottom:5rem;left:50%;transform:translateX(-50%) translateY(20px);z-index:10001;background:rgba(44,36,32,.92);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);color:#FBF8F5;padding:.7rem 1.4rem;border-radius:12px;font-size:.78rem;opacity:0;transition:all .35s cubic-bezier(.22,1,.36,1);pointer-events:none;white-space:nowrap;font-family:'Zen Kaku Gothic New',sans-serif;box-shadow:0 4px 20px rgba(0,0,0,.2)}
.story-toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
[data-theme="dark"] .story-toast{background:rgba(60,55,50,.92)}
/* === Story Mode === */
.story-play-btn{background:linear-gradient(135deg,var(--sakura),var(--sakura-deep))!important;color:#fff!important;border-color:var(--sakura)!important;font-size:.7rem!important;letter-spacing:1px}
.story-play-btn:hover{opacity:.85;transform:scale(1.05)}
.story-overlay{position:fixed;inset:0;z-index:10000;background:#0a0908;display:none;flex-direction:column;touch-action:pan-y}
.story-overlay.active{display:flex}
.story-progress-bar{position:absolute;top:0;left:0;right:0;display:flex;gap:3px;padding:12px 10px 0;z-index:10}
.story-progress-seg{flex:1;height:2.5px;background:rgba(255,255,255,.2);border-radius:2px;overflow:hidden}
.story-progress-fill{height:100%;background:#fff;width:0;border-radius:2px}
.story-progress-fill.done{width:100%!important;transition:none}
.story-progress-fill.active{transition:width linear}
.story-close{position:absolute;top:18px;right:14px;z-index:12;background:none;border:none;color:rgba(255,255,255,.7);font-size:1.5rem;cursor:pointer;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:background .2s}
.story-close:hover{background:rgba(255,255,255,.1)}
.story-slide-container{flex:1;position:relative;overflow:hidden}
.story-slide{position:absolute;inset:0;display:flex;flex-direction:column;opacity:0;transform:scale(1.02);transition:opacity .5s ease,transform .5s ease;pointer-events:none}
.story-slide.active{opacity:1;transform:scale(1);pointer-events:auto}
.story-slide.exit-left{opacity:0;transform:translateX(-8%) scale(.98)}
.story-slide.enter-right{opacity:0;transform:translateX(8%) scale(.98)}
/* Touch zones */
.story-touch{position:absolute;inset:0;z-index:5;display:flex}
.story-touch-left,.story-touch-right{flex:1}
.story-touch-center{width:30%}
/* Slide types */
.story-opening{align-items:center;justify-content:center;text-align:center;background:linear-gradient(135deg,#1a1614,#2C2420 40%,#3D2E28)}
.story-opening::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 30% 40%,rgba(242,167,179,.1),transparent 60%),radial-gradient(ellipse at 70% 60%,rgba(196,162,101,.08),transparent 50%)}
.story-opening-label{font-family:'Caveat',cursive;color:var(--sakura);font-size:1.1rem;letter-spacing:.2em;opacity:0;animation:storyFadeUp .8s .3s forwards}
.story-opening-title{font-family:'Zen Old Mincho',serif;font-size:4rem;color:#FBF8F5;letter-spacing:.25em;margin:.3rem 0;opacity:0;animation:storyFadeUp .8s .5s forwards;position:relative;z-index:1}
.story-opening-line{width:50px;height:1px;background:var(--sakura);margin:.8rem auto;opacity:0;animation:storyFadeUp .6s .7s forwards}
.story-opening-dates{font-family:'Zen Kaku Gothic New',sans-serif;font-size:.9rem;color:var(--gold-light);letter-spacing:.25em;opacity:0;animation:storyFadeUp .8s .9s forwards}
.story-opening-meta{font-size:.78rem;color:rgba(251,248,245,.4);margin-top:1.5rem;letter-spacing:.1em;opacity:0;animation:storyFadeUp .8s 1.1s forwards}
.story-opening-petals{position:absolute;inset:0;pointer-events:none;overflow:hidden}
.story-opening-petal{position:absolute;font-size:1.2rem;opacity:0;animation:storyPetalFall 4s linear infinite}
@keyframes storyPetalFall{0%{opacity:0;transform:translateY(-20px) rotate(0)}10%{opacity:.5}80%{opacity:.4}100%{opacity:0;transform:translateY(100vh) rotate(360deg)}}
@keyframes storyFadeUp{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}
/* Route slide */
.story-route{align-items:center;justify-content:center;background:linear-gradient(160deg,#1a1614,#252220)}
.story-route-title{font-family:'Caveat',cursive;color:var(--sakura);font-size:1rem;letter-spacing:.15em;margin-bottom:1.5rem;opacity:0;animation:storyFadeUp .6s .2s forwards}
.story-route svg{max-width:320px;width:85%}
.story-route-stats{display:flex;gap:2rem;margin-top:2rem;opacity:0;animation:storyFadeUp .6s 1.5s forwards}
.story-route-stat{text-align:center}
.story-route-stat-num{font-family:'Zen Old Mincho',serif;font-size:1.6rem;color:#FBF8F5;font-weight:700}
.story-route-stat-label{font-size:.65rem;color:rgba(251,248,245,.4);letter-spacing:.1em;margin-top:.15rem}
/* Day break slide */
.story-daybreak{align-items:center;justify-content:center;text-align:center;background:linear-gradient(135deg,#1a1614,#1e1c1a)}
.story-daybreak-num{font-family:'Caveat',cursive;color:var(--sakura);font-size:1rem;letter-spacing:.2em;opacity:0;animation:storyFadeUp .6s .2s forwards}
.story-daybreak-date{font-family:'Zen Old Mincho',serif;font-size:2.8rem;color:#FBF8F5;letter-spacing:.15em;margin:.3rem 0;opacity:0;animation:storyFadeUp .7s .4s forwards}
.story-daybreak-weekday{font-size:.85rem;color:rgba(251,248,245,.35);letter-spacing:.15em;opacity:0;animation:storyFadeUp .6s .6s forwards}
/* Spot slide */
.story-spot{position:relative;background:#0a0908}
.story-spot-img-wrap{position:absolute;inset:0}
.story-spot-img-bg{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;filter:brightness(.5) saturate(.7);transform:scale(1.1)}
.story-spot-img{position:absolute;inset:0;width:100%;height:100%;object-fit:contain;object-position:center 35%;opacity:0;transition:opacity .8s;animation:storyKenBurns 8s ease-out forwards;z-index:1}
.story-spot-img.loaded{opacity:1}
@keyframes storyKenBurns{from{transform:scale(1.08)}to{transform:scale(1)}}
.story-spot-gradient{position:absolute;inset:0;z-index:2;background:linear-gradient(to top,rgba(10,9,8,.95) 0%,rgba(10,9,8,.5) 25%,rgba(10,9,8,0) 48%,rgba(10,9,8,.05) 100%)}
.story-spot-content{position:absolute;bottom:0;left:0;right:0;padding:2rem 1.5rem 3rem;z-index:3}
.story-spot-category{display:inline-block;font-size:.6rem;letter-spacing:.15em;text-transform:uppercase;padding:.2rem .6rem;border-radius:3px;margin-bottom:.6rem;font-weight:600}
.story-spot-category.sight{background:rgba(123,143,78,.25);color:#c8d8a0}
.story-spot-category.food{background:rgba(212,135,77,.25);color:#e8b88a}
.story-spot-name{font-family:'Zen Old Mincho',serif;font-size:1.8rem;color:#FBF8F5;letter-spacing:.08em;line-height:1.3;margin-bottom:.5rem;opacity:0;animation:storyFadeUp .6s .15s forwards}
.story-spot-time{font-size:.72rem;color:rgba(251,248,245,.4);letter-spacing:.08em;margin-bottom:.6rem;opacity:0;animation:storyFadeUp .5s .3s forwards}
.story-spot-stars{display:flex;gap:2px;margin-bottom:.5rem;opacity:0;animation:storyFadeUp .5s .4s forwards}
.story-spot-star{font-size:1rem}
.story-spot-comment{font-size:.88rem;color:rgba(251,248,245,.75);line-height:1.7;font-style:italic;opacity:0;animation:storyFadeUp .6s .5s forwards;max-width:85%}
/* Ending slide */
.story-ending{align-items:center;justify-content:center;text-align:center;background:linear-gradient(135deg,#1a1614,#2C2420);position:relative;overflow:hidden}
.story-ending::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 50% 50%,rgba(242,167,179,.08),transparent 70%)}
.story-ending-stats{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem 2.5rem;margin-bottom:2rem;opacity:0;animation:storyFadeUp .7s .3s forwards}
.story-ending-stat-num{font-family:'Zen Old Mincho',serif;font-size:2.2rem;color:#FBF8F5;font-weight:700;line-height:1}
.story-ending-stat-label{font-size:.68rem;color:rgba(251,248,245,.35);letter-spacing:.1em;margin-top:.25rem}
.story-ending-best{margin:1.5rem 0;padding:1rem 1.5rem;background:rgba(255,255,255,.04);border-radius:12px;border:1px solid rgba(255,255,255,.06);opacity:0;animation:storyFadeUp .7s .8s forwards}
.story-ending-best-label{font-size:.65rem;color:var(--sakura);letter-spacing:.15em;margin-bottom:.4rem}
.story-ending-best-name{font-family:'Zen Old Mincho',serif;font-size:1.3rem;color:#FBF8F5;letter-spacing:.1em}
.story-ending-best-stars{display:flex;justify-content:center;gap:2px;margin-top:.3rem}
.story-ending-title{font-family:'Zen Old Mincho',serif;font-size:2rem;color:#FBF8F5;letter-spacing:.2em;margin-top:1.5rem;opacity:0;animation:storyFadeUp .7s 1.2s forwards}
.story-ending-sub{font-size:.8rem;color:rgba(251,248,245,.3);letter-spacing:.15em;margin-top:.4rem;opacity:0;animation:storyFadeUp .6s 1.4s forwards}
.story-ending-petal{font-size:1.8rem;margin-top:1.5rem;opacity:0;animation:storyFadeUp .5s 1.6s forwards}
/* Pause indicator */
.story-paused-indicator{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:15;font-size:2.5rem;color:rgba(255,255,255,.6);opacity:0;transition:opacity .2s;pointer-events:none}
.story-overlay.paused .story-paused-indicator{opacity:1}
.story-overlay.paused .story-progress-fill.active{animation-play-state:paused!important}
/* Story landscape mode */
@media (orientation:landscape) and (max-height:500px){
.story-progress-bar{padding:6px 10px 0}
.story-close{top:8px;right:10px;width:30px;height:30px;font-size:1.2rem}
/* Opening */
.story-opening-title{font-size:2.5rem}
.story-opening-label{font-size:.9rem}
.story-opening-dates{font-size:.8rem}
.story-opening-meta{margin-top:.6rem}
.story-opening-line{margin:.4rem auto}
/* Route */
.story-route svg{max-width:250px;width:60%}
.story-route-title{margin-bottom:.6rem;font-size:.85rem}
.story-route-stats{margin-top:.8rem;gap:1.5rem}
.story-route-stat-num{font-size:1.2rem}
/* Daybreak */
.story-daybreak-date{font-size:2rem}
.story-daybreak-num{font-size:.85rem}
/* Spot ‚Äî side-by-side layout */
.story-spot-gradient{background:linear-gradient(to right,rgba(10,9,8,.97) 0%,rgba(10,9,8,.6) 30%,rgba(10,9,8,.05) 55%,rgba(10,9,8,.15) 100%)}
.story-spot-content{inset:0;padding:2.5rem 1.2rem 1.2rem;display:flex;flex-direction:column;justify-content:flex-end;max-width:55%}
.story-spot-img{object-position:center center}
.story-spot-name{font-size:1.3rem;margin-bottom:.3rem}
.story-spot-time{font-size:.65rem;margin-bottom:.3rem}
.story-spot-stars .story-spot-star{font-size:.85rem}
.story-spot-comment{font-size:.75rem;line-height:1.5;max-width:100%}
.story-spot-category{font-size:.55rem;margin-bottom:.3rem}
/* Ending */
.story-ending-stats{gap:.8rem 2rem}
.story-ending-stat-num{font-size:1.6rem}
.story-ending-stat-label{font-size:.6rem}
.story-ending-best{margin:.6rem 0;padding:.6rem 1.2rem}
.story-ending-best-name{font-size:1rem}
.story-ending-title{font-size:1.5rem;margin-top:.6rem}
.story-ending-sub{font-size:.7rem}
.story-ending-petal{margin-top:.5rem;font-size:1.2rem}
}
/* Wider landscape (tablets, desktop) */
@media (orientation:landscape) and (min-height:501px){
.story-spot-content{max-width:50%;padding:2rem 2rem 3rem}
.story-spot-gradient{background:linear-gradient(to right,rgba(10,9,8,.9) 0%,rgba(10,9,8,.45) 35%,rgba(10,9,8,.05) 60%,rgba(10,9,8,.15) 100%)}
.story-spot-img{object-position:center center}
}
</style>
</head>
<body>
<script>
// Service Worker registration
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('./sw.js').then(function(reg) {
      // Check for updates every 30 minutes
      setInterval(function() { reg.update(); }, 1800000);
      // When a new SW is waiting, activate it immediately
      reg.addEventListener('updatefound', function() {
        var newWorker = reg.installing;
        if (newWorker) {
          newWorker.addEventListener('statechange', function() {
            if (newWorker.state === 'activated') {
              console.log('Service Worker updated');
            }
          });
        }
      });
    }).catch(function(err) { console.warn('SW registration failed:', err); });
  });
}
</script>
<div class="sakura-container" id="sakuraContainer"></div>

<section class="hero">
  <div class="hero-pattern"></div>
  <div class="hero-content">
    <div class="hero-label" lang="en">My Travel Journal</div>
    <h1 class="hero-title">‰∫¨ÈÉΩ</h1>
    <div class="hero-divider"></div>
    <div class="hero-dates">2026.3.14 ‚Äî 3.16 &#12288; 2Ê≥ä3Êó•</div>
    <div class="hero-meta">
      <div class="hero-meta-item">ÂÆøÊ≥ä <span>„Éõ„ÉÜ„É´„Ç®„Éü„Ç™„É≥‰∫¨ÈÉΩ</span></div>
      <div class="hero-meta-item">Âá∫Áô∫ <span>ÁÜäË∞∑ÈßÖ</span></div>
    </div>
  </div>
  <div class="scroll-hint" lang="en">SCROLL</div>
</section>

<nav class="day-nav" id="dayNav">
  <div class="day-nav-inner">
    <div class="nav-brand" id="navBrand">‰∫¨ÈÉΩ</div>
    <div class="nav-days">
      <button class="nav-day-btn active" data-target="day1" lang="en">Day 1</button>
      <button class="nav-day-btn" data-target="day2" lang="en">Day 2</button>
      <button class="nav-day-btn" data-target="day3" lang="en">Day 3</button>
    </div>
    <div class="nav-actions">
      <button class="nav-icon-btn story-play-btn" id="storyBtn" title="„Çπ„Éà„Éº„É™„Éº„É¢„Éº„Éâ">‚ñ∂</button>
      <button class="nav-icon-btn" id="shareBtn" title="ÂÖ±Êúâ">üì§</button>
      <button class="nav-icon-btn" id="qrBtn" title="QR„Ç≥„Éº„ÉâÂÖ±Êúâ">üì±</button>
      <button class="nav-icon-btn" id="costBtn" title="Ë≤ªÁî®‰∏ÄË¶ß">üí∞</button>
      <button class="nav-icon-btn" id="themeBtn" title="„ÉÜ„Éº„ÉûÂàáÊõø">üåô</button>
      <button class="nav-icon-btn help-btn" id="helpBtn" title="‰Ωø„ÅÑÊñπ„Ç¨„Ç§„Éâ">?</button>
    </div>
  </div>
</nav>

<div class="travel-progress" id="travelProgress">
  <div class="travel-progress-inner">
    <span class="travel-progress-text" id="travelProgressText">ÊóÖ„ÅÆÈÄ≤Êçó</span>
    <div class="travel-progress-bar"><div class="travel-progress-fill" id="travelProgressFill"></div></div>
    <span class="travel-progress-text" id="travelProgressPct">0%</span>
  </div>
</div>

<div class="content-section" id="infoSection">
  <div class="countdown-card">
    <div class="countdown-title">üå∏ ‰∫¨ÈÉΩÊóÖË°å„Åæ„Åß</div>
    <div class="countdown-display" id="countdownDisplay">‚Äî</div>
    <div class="countdown-sub" id="countdownSub"></div>
  </div>

  <div class="weather-card">
    <div class="info-card-title">üå§ ‰∫¨ÈÉΩ„ÅÆÂ§©Ê∞ó‰∫àÂ†±Ôºà3/14„Äú3/16Ôºâ</div>
    <div class="weather-days" id="weatherDays"><div class="weather-loading">Â§©Ê∞óÊÉÖÂ†±„ÇíÂèñÂæó‰∏≠...</div></div>
    <div class="weather-note" id="weatherNote"></div>
    <div class="weather-current" id="weatherCurrent" style="display:none">
      <div class="weather-current-title">üìç ‰∫¨ÈÉΩ„ÅÆ‰ªä„ÅÆÂ§©Ê∞ó</div>
      <div class="weather-current-body" id="weatherCurrentBody"></div>
    </div>
    <div class="weather-history" id="weatherHistory" style="display:none">
      <div class="weather-history-title">üìä 3Êúà‰∏≠Êó¨„ÅÆÂπ≥Âπ¥ÂÄ§Ôºà‰∫¨ÈÉΩÔºâ</div>
      <div class="weather-history-body">
        <div class="weather-history-row"><span class="weather-history-label">ÊúÄÈ´òÊ∞óÊ∏©</span><span class="weather-history-value">13„Äú15‚ÑÉ</span></div>
        <div class="weather-history-row"><span class="weather-history-label">ÊúÄ‰ΩéÊ∞óÊ∏©</span><span class="weather-history-value">3„Äú5‚ÑÉ</span></div>
        <div class="weather-history-row"><span class="weather-history-label">ÈôçÊ∞¥Á¢∫Áéá</span><span class="weather-history-value">Á¥Ñ35%</span></div>
        <div class="weather-history-row"><span class="weather-history-label">ÊúçË£Ö„ÅÆÁõÆÂÆâ</span><span class="weather-history-value">„Ç≥„Éº„ÉàÔºãËñÑÊâã„ÅÆ„Éã„ÉÉ„Éà</span></div>
      </div>
    </div>
  </div>

  <div class="info-card">
    <div class="info-card-title">üéÅ „ÅäÂúüÁî£„ÉÅ„Çß„ÉÉ„ÇØ„É™„Çπ„Éà</div>
    <div class="omiyage-grid" id="omiyageList">
      <div class="omiyage-section">
        <div class="omiyage-section-title">üìç „Ç∏„Çß„Ç§„Ç¢„Éº„É´‰∫¨ÈÉΩ‰ºäÂã¢‰∏πÔºà‰∫¨ÈÉΩÈßÖ„ÉªDay3Ôºâ</div>
        <label class="omiyage-check" data-key="om1"><span class="omiyage-check-box">‚úì</span><span class="omiyage-item-name">ÈòøÈóçÊ¢®È§Ö</span><span class="omiyage-item-for">‚Üí Ëá™ÂÆÖ„ÉªÁ¶èÊ≤¢„Éª‰∫ãÂãô</span></label>
      </div>
      <div class="omiyage-section">
        <div class="omiyage-section-title">üìç Ê∏ÖÊ∞¥ÂØ∫„Ç®„É™„Ç¢ÔºàDay2Ôºâ</div>
        <label class="omiyage-check" data-key="om2"><span class="omiyage-check-box">‚úì</span><span class="omiyage-item-name">„Åµ„Çè„Åµ„Çè„Åä„Åü„Åπ</span><span class="omiyage-item-for">‚Üí Ëá™ÂÆÖ„ÉªÊòéÂíå„ÉªÊ∞¥Èáé„Éª‰∫ãÂãô</span></label>
        <label class="omiyage-check" data-key="om3"><span class="omiyage-check-box">‚úì</span><span class="omiyage-item-name">„Éï„Ç£„Éä„É≥„Ç∑„Çß</span><span class="omiyage-item-for">‚Üí Ëá™ÂÆÖ„ÉªÊòéÂíå„ÉªÊ∞¥Èáé„ÉªÁ¶èÊ≤¢„Éª‰∫ãÂãô</span></label>
      </div>
      <div class="omiyage-section">
        <div class="omiyage-section-title">üìç „Éë„Éë‰ºöÁ§æÂêë„ÅëÔºàÊú™ÂÆöÔºâ</div>
        <label class="omiyage-check" data-key="om4"><span class="omiyage-check-box">‚úì</span><span class="omiyage-item-name">„Éë„Éë‰ºöÁ§æÁî®„ÅäÂúüÁî£</span><span class="omiyage-item-for">‚Üí Ë¶ÅÊ§úË®é</span></label>
      </div>
    </div>
    <div class="omiyage-progress"><div class="omiyage-progress-bar"><div class="omiyage-progress-fill" id="omiyageProgressFill"></div></div><span class="omiyage-progress-text" id="omiyageProgressText">0/4</span></div>
  </div>

  <div class="info-card">
    <div class="info-card-title">üöÑ Êñ∞ÂππÁ∑ö„ÉªÂÆøÊ≥äË≤ª</div>
    <div style="display:grid;gap:.3rem">
      <div style="display:flex;justify-content:space-between;align-items:center;font-size:.85rem;padding:.5rem .7rem;background:var(--card-bg);border-radius:8px;transition:background .4s"><span>ÁÜäË∞∑ ‚ñ∂ Êù±‰∫¨ÔºàÂæÄÂæ©Ôºâ</span><span style="font-weight:600;color:var(--transport)">¬•19,500</span></div>
      <div style="display:flex;justify-content:space-between;align-items:center;font-size:.85rem;padding:.5rem .7rem;background:var(--card-bg);border-radius:8px;transition:background .4s"><span>Êù±‰∫¨ ‚ñ∂ ‰∫¨ÈÉΩ</span><span style="font-weight:600;color:var(--transport)">¬•69,850</span></div>
      <div style="display:flex;justify-content:space-between;align-items:center;font-size:.85rem;padding:.5rem .7rem;background:var(--card-bg);border-radius:8px;transition:background .4s"><span>‰∫¨ÈÉΩ ‚ñ∂ Êù±‰∫¨</span><span style="font-weight:600;color:var(--transport)">¬•57,520</span></div>
      <div style="display:flex;justify-content:space-between;align-items:center;font-size:.85rem;padding:.5rem .7rem;background:var(--card-bg);border-radius:8px;transition:background .4s"><span>üè® „Éõ„ÉÜ„É´„Ç®„Éü„Ç™„É≥</span><span style="font-weight:600;color:var(--hotel)">¬•135,129</span></div>
      <div style="display:flex;justify-content:space-between;align-items:center;font-size:.9rem;padding:.6rem .7rem;margin-top:.3rem;border-top:1px solid rgba(128,128,128,.15)"><span style="font-weight:600">ÂêàË®à</span><span style="font-weight:700;color:var(--sakura-deep);font-size:1rem">¬•281,999</span></div>
    </div>
  </div>

  <div class="emergency-card">
    <div class="info-card-title">üìç ‰∏ªË¶Å„Çπ„Éù„ÉÉ„ÉàÊâÄÂú®Âú∞</div>
    <div class="emergency-grid">
      <div class="emergency-item"><span class="emergency-icon">üè®</span><div class="emergency-info"><div class="emergency-label">„Éõ„ÉÜ„É´„Ç®„Éü„Ç™„É≥‰∫¨ÈÉΩ</div><div class="emergency-value">Ê¢ÖÂ∞èË∑Ø‰∫¨ÈÉΩË•øÈßÖ ÂæíÊ≠©1ÂàÜ</div><a href="tel:075-323-2727" class="emergency-tel">üìû 075-323-2727</a></div></div>
      <div class="emergency-item"><span class="emergency-icon">üöÑ</span><div class="emergency-info"><div class="emergency-label">‰∫¨ÈÉΩÈßÖ</div><div class="emergency-value">„Éõ„ÉÜ„É´„Åã„ÇâJR1ÈßÖ</div></div></div>
      <div class="emergency-item"><span class="emergency-icon">‚õ©</span><div class="emergency-info"><div class="emergency-label">‰ºèË¶ãÁ®≤Ëç∑Â§ßÁ§æ</div><div class="emergency-value">JRÁ®≤Ëç∑ÈßÖ„Åô„Åê</div></div></div>
      <div class="emergency-item"><span class="emergency-icon">üèØ</span><div class="emergency-info"><div class="emergency-label">ÈáëÈñ£ÂØ∫</div><div class="emergency-value">Â∏Ç„Éê„ÇπÈáëÈñ£ÂØ∫ÈÅì‰∏ãËªä</div></div></div>
      <div class="emergency-item"><span class="emergency-icon">üåä</span><div class="emergency-info"><div class="emergency-label">Ê∏ÖÊ∞¥ÂØ∫</div><div class="emergency-value">Â∏Ç„Éê„ÇπÊ∏ÖÊ∞¥ÈÅì ÂæíÊ≠©10ÂàÜ</div></div></div>
      <div class="emergency-item"><span class="emergency-icon">üéã</span><div class="emergency-info"><div class="emergency-label">ÂµêÂ±±„ÉªÂ§©ÈæçÂØ∫</div><div class="emergency-value">JRÂµØÂ≥®ÂµêÂ±±ÈßÖ ÂæíÊ≠©10ÂàÜ</div></div></div>
    </div>
  </div>

  <div class="station-card">
    <div class="info-card-title">üó∫ ÈßÖ„ÅßËø∑„Å£„Åü„ÇâÔºàÊßãÂÜÖÂõ≥Ôºâ</div>
    <div class="station-card-desc">„Çø„ÉÉ„Éó„ÅßÂêÑÈßÖ„ÅÆÂÖ¨ÂºèÊßãÂÜÖÂõ≥„ÇíÈñã„Åë„Åæ„Åô„ÄÇ„Éõ„Éº„É†Áï™Âè∑„ÅØÊóÖÁ®ã„Ç´„Éº„Éâ„Å´„ÇÇË®òËºâ„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</div>
    <div class="station-grid">
      <div class="station-item"><div class="station-name">üöÑ Êù±‰∫¨ÈßÖ</div><div class="station-links"><a href="https://railway.jr-central.co.jp/station-guide/shinkansen/tokyo/map.html" target="_blank" rel="noopener" class="station-link">Êñ∞ÂππÁ∑öÔºàJRÊù±Êµ∑Ôºâ</a><a href="https://www.jreast.co.jp/estation/stations/1039.html" target="_blank" rel="noopener" class="station-link">Âú®Êù•Á∑öÔºàJRÊù±Êó•Êú¨Ôºâ</a></div></div>
      <div class="station-item"><div class="station-name">üöÑ ‰∫¨ÈÉΩÈßÖ</div><div class="station-links"><a href="https://3dmap.jrnc.jp/JRW/mobile/#/kyotoja/" target="_blank" rel="noopener" class="station-link">3DÊßãÂÜÖÂõ≥</a><a href="https://railway.jr-central.co.jp/station-guide/shinkansen/kyoto/" target="_blank" rel="noopener" class="station-link">Êñ∞ÂππÁ∑öÔºàJRÊù±Êµ∑Ôºâ</a></div></div>
    </div>
  </div>

  <div class="checklist-card">
    <div class="info-card-title">‚úÖ ÊåÅ„Å°Áâ©„ÉÅ„Çß„ÉÉ„ÇØ„É™„Çπ„Éà</div>
    <div class="checklist-columns" id="checklist">
      <label class="check-item" data-key="c1"><span class="check-box">‚úì</span>Êñ∞ÂππÁ∑ö„ÉÅ„Ç±„ÉÉ„Éà</label>
      <label class="check-item" data-key="c2"><span class="check-box">‚úì</span>„Éõ„ÉÜ„É´‰∫àÁ¥ÑÁ¢∫Ë™çÊõ∏</label>
      <label class="check-item" data-key="c3"><span class="check-box">‚úì</span>„Çπ„Éû„ÉõÂÖÖÈõªÂô®</label>
      <label class="check-item" data-key="c4"><span class="check-box">‚úì</span>„É¢„Éê„Ç§„É´„Éê„ÉÉ„ÉÜ„É™„Éº</label>
      <label class="check-item" data-key="c5"><span class="check-box">‚úì</span>ÁùÄÊõø„ÅàÔºà2Ê≥äÂàÜÔºâ</label>
      <label class="check-item" data-key="c6"><span class="check-box">‚úì</span>„Éë„Ç∏„É£„Éû</label>
      <label class="check-item" data-key="c7"><span class="check-box">‚úì</span>Ê≠Ø„Éñ„É©„Ç∑„ÉªÊ¥óÈù¢ÂÖ∑</label>
      <label class="check-item" data-key="c8"><span class="check-box">‚úì</span>Â∏∏ÂÇôËñ¨</label>
      <label class="check-item" data-key="c9"><span class="check-box">‚úì</span>Êäò„Çä„Åü„Åü„ÅøÂÇò</label>
      <label class="check-item" data-key="c10"><span class="check-box">‚úì</span>„ÅäÂúüÁî£„É™„Çπ„Éà</label>
      <label class="check-item" data-key="c11"><span class="check-box">‚úì</span>„Ç´„É°„É©</label>
      <label class="check-item" data-key="c12"><span class="check-box">‚úì</span>ÁèæÈáë„ÉªIC„Ç´„Éº„Éâ</label>
      <label class="check-item" data-key="c13"><span class="check-box">‚úì</span>„Ç®„Ç≥„Éê„ÉÉ„Ç∞</label>
      <label class="check-item" data-key="c14"><span class="check-box">‚úì</span>„Éè„É≥„Ç´„ÉÅ„Éª„ÉÜ„Ç£„ÉÉ„Ç∑„É•</label>
    </div>
    <div class="add-item-row">
      <input type="text" class="add-item-input" id="addCheckInput" placeholder="ÊåÅ„Å°Áâ©„ÇíËøΩÂä†‚Ä¶" maxlength="30">
      <button class="add-item-btn" id="addCheckBtn">Ôºã ËøΩÂä†</button>
    </div>
    <div class="checklist-progress"><div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div><span class="progress-text" id="progressText">0/14</span></div>
  </div>

  <div class="memo-card">
    <div class="info-card-title">üìù „É°„É¢</div>
    <div class="memo-tabs">
      <button class="memo-tab active" data-memo="general">ÂÖ±ÈÄö</button>
      <button class="memo-tab" data-memo="day1">Day 1</button>
      <button class="memo-tab" data-memo="day2">Day 2</button>
      <button class="memo-tab" data-memo="day3">Day 3</button>
    </div>
    <textarea class="memo-textarea" id="memoArea" placeholder="ÂΩìÊó•„ÅÆÂ§âÊõ¥„ÇÑ„É°„É¢„Çí„Åì„Åì„Å´Êõ∏„ÅçËæº„ÇÅ„Åæ„Åô..."></textarea>
    <div class="memo-saved" id="memoSaved">‚úì ‰øùÂ≠ò„Åó„Åæ„Åó„Åü</div>
  </div>

  <div class="album-card">
    <div class="info-card-title">üì∑ ÊóÖ„ÅÆÊÄù„ÅÑÂá∫„Ç¢„É´„Éê„É†</div>
    <div class="album-grid" id="albumGrid">
      <div class="album-slot" data-slot="0"><span class="album-slot-icon">üì∑</span><span class="album-slot-text">„Çø„ÉÉ„Éó„ÅßËøΩÂä†</span><input type="file" accept="image/*"></div>
      <div class="album-slot" data-slot="1"><span class="album-slot-icon">üì∑</span><span class="album-slot-text">„Çø„ÉÉ„Éó„ÅßËøΩÂä†</span><input type="file" accept="image/*"></div>
      <div class="album-slot" data-slot="2"><span class="album-slot-icon">üì∑</span><span class="album-slot-text">„Çø„ÉÉ„Éó„ÅßËøΩÂä†</span><input type="file" accept="image/*"></div>
      <div class="album-slot" data-slot="3"><span class="album-slot-icon">üì∑</span><span class="album-slot-text">„Çø„ÉÉ„Éó„ÅßËøΩÂä†</span><input type="file" accept="image/*"></div>
      <div class="album-slot" data-slot="4"><span class="album-slot-icon">üì∑</span><span class="album-slot-text">„Çø„ÉÉ„Éó„ÅßËøΩÂä†</span><input type="file" accept="image/*"></div>
      <div class="album-slot" data-slot="5"><span class="album-slot-icon">üì∑</span><span class="album-slot-text">„Çø„ÉÉ„Éó„ÅßËøΩÂä†</span><input type="file" accept="image/*"></div>
    </div>
  </div>
</div>

<!-- DAY 1 -->
<section class="content-section" id="day1">
  <div class="day-header"><div class="day-number" lang="en">Day 1</div><div class="day-date">3/14</div><div class="day-weekday">ÂúüÊõúÊó•</div></div>
  <div class="timeline" data-day="2026-03-14">
    <div class="timeline-item" data-time="06:57"><div class="timeline-time">06:57</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">ÁÜäË∞∑ÈßÖ„ÇíÂá∫Áô∫</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">JR„Åü„Å´„Åå„Çè400Âè∑ 11„Éª12Áï™Á∑ö<br>Ëá™Áî±Â∏≠<br>7:36ÁùÄ Êù±‰∫¨ÈßÖ 20Áï™Á∑ö</div><div class="card-bottom"><a href="https://maps.google.com/maps?q=ÁÜäË∞∑ÈßÖ" target="_blank" rel="noopener" class="card-link">üìç MAP</a><a href="https://www.jreast-timetable.jp/timetable/list1039.html" target="_blank" rel="noopener" class="card-link site-link">üïê ÊôÇÂàªË°®</a></div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± Á¥Ñ1ÊôÇÈñì</div></div>
    <div class="timeline-item" data-time="08:00"><div class="timeline-time">08:00</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">Êù±‰∫¨ÈßÖÂá∫Áô∫</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">JR„ÅÆ„Åû„Åø61Âè∑ 19Áï™Á∑ö<br>13Âè∑Ëªä1Áï™ABCDEÂ∏≠<br>Ëàú„Å®Ê•ΩÊñó„Å®ÈõÜÂêà</div>
<div class="seat-chart">
<div class="seat-chart-title">üöÖ Â∫ßÂ∏≠Ë°® ‚Äî 13Âè∑Ëªä 1Áï™ABCDE</div>
<div class="seat-train-dir"><span>‚Üê ÂçöÂ§öÊñπÈù¢</span><span>Êù±‰∫¨ÊñπÈù¢ ‚Üí</span></div>
<div class="seat-train-cars">
<div class="seat-train-car">1</div><div class="seat-train-car">2</div><div class="seat-train-car">3</div><div class="seat-train-car">4</div><div class="seat-train-car">5</div><div class="seat-train-car">6</div><div class="seat-train-car">7</div><div class="seat-train-car green">8</div><div class="seat-train-car green">9</div><div class="seat-train-car green">10</div><div class="seat-train-car">11</div><div class="seat-train-car">12</div><div class="seat-train-car ours">13</div><div class="seat-train-car">14</div><div class="seat-train-car">15</div><div class="seat-train-car">16</div>
</div>
<div class="seat-layout">
<div class="seat-layout-title">13Âè∑Ëªä Â∫ßÂ∏≠ÈÖçÁΩÆ</div>
<div class="seat-layout-dir">‚Üë ÂçöÂ§öÂØÑ„ÇäÔºàÂâçÊñπÔºâ</div>
<div class="seat-col-header">
<div class="seat-col-num-spacer"></div>
<div class="seat-col-label">A</div><div class="seat-col-label">B</div><div class="seat-col-label">C</div>
<div class="seat-col-aisle"></div>
<div class="seat-col-label">D</div><div class="seat-col-label">E</div>
</div>
<div class="seat-row"><div class="seat-row-num">1</div><div class="seat-cell ours">A</div><div class="seat-cell ours">B</div><div class="seat-cell ours">C</div><div class="seat-aisle"></div><div class="seat-cell ours">D</div><div class="seat-cell ours">E</div></div>
<div class="seat-row"><div class="seat-row-num">2</div><div class="seat-cell">A</div><div class="seat-cell">B</div><div class="seat-cell">C</div><div class="seat-aisle"></div><div class="seat-cell">D</div><div class="seat-cell">E</div></div>
<div class="seat-row"><div class="seat-row-num">3</div><div class="seat-cell">A</div><div class="seat-cell">B</div><div class="seat-cell">C</div><div class="seat-aisle"></div><div class="seat-cell">D</div><div class="seat-cell">E</div></div>
<div class="seat-layout-dir">‚Üì Êù±‰∫¨ÂØÑ„ÇäÔºàÂæåÊñπÔºâ</div>
</div>
<div class="seat-legend">
<div class="seat-legend-item"><div class="seat-legend-box ours"></div> Ëá™ÂàÜ„Åü„Å°„ÅÆÂ∏≠</div>
<div class="seat-legend-item"><div class="seat-legend-box green"></div> „Ç∞„É™„Éº„É≥Ëªä</div>
</div>
</div><div class="card-bottom"><a href="https://maps.google.com/maps?q=Êù±‰∫¨ÈßÖ+Êñ∞ÂππÁ∑ö„Éõ„Éº„É†" target="_blank" rel="noopener" class="card-link">üìç MAP</a></div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± „ÅÆ„Åû„Åø Á¥Ñ2ÊôÇÈñì15ÂàÜ</div></div>
    <div class="timeline-item" data-time="10:15"><div class="timeline-time">10:15</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">‰∫¨ÈÉΩÈßÖÁùÄ</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">14Áï™Á∑öÁùÄ</div><div class="card-bottom"><a href="https://maps.google.com/maps?q=‰∫¨ÈÉΩÈßÖ" target="_blank" rel="noopener" class="card-link">üìç MAP</a></div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± JRÂµØÂ≥®ÈáéÁ∑ö 12ÂàÜ</div></div>
    <div class="timeline-item" data-time="10:27"><div class="timeline-time">10:27</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">JRÂµØÂ≥®ÈáéÁ∑öÂá∫Áô∫</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">33Áï™Á∑ö</div><div class="card-bottom"><span class="card-cost">¬•150</span></div></div></div>
    <div class="timeline-item" data-time="10:35"><div class="timeline-time">10:35</div><div class="timeline-dot hotel"></div><span class="now-label">üìç NOW</span><div class="timeline-card hotel"><div class="card-header"><div class="card-title">„Éõ„ÉÜ„É´„Ç®„Éü„Ç™„É≥‰∫¨ÈÉΩÁùÄ</div><span class="card-category hotel">ÂÆøÊ≥ä</span></div><div class="card-detail">Ëç∑Áâ©È†ê„Åë„Çã<br>Ê¨°„ÅÆÊó•„ÅÆ„Éê„Çπ1Êó•Âà∏Ë≥ºÂÖ•„Åô„ÇãÔºà1,100ÂÜÜ/‰∫∫Ôºâ<br>Ë≥ºÂÖ•Â†¥ÊâÄ„ÅÆÁ¢∫Ë™ç</div><div class="card-bottom"><span class="card-cost">¬•1,100 /‰∫∫</span><a href="https://maps.google.com/maps?q=„Éõ„ÉÜ„É´„Ç®„Éü„Ç™„É≥‰∫¨ÈÉΩ" target="_blank" rel="noopener" class="card-link">üìç MAP</a><a href="https://www.hotel-emion.jp/kyoto/" target="_blank" rel="noopener" class="card-link site-link">üîó ÂÖ¨Âºè</a></div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± ÂæíÊ≠©+„Éê„Çπ Á¥Ñ30ÂàÜ</div></div>
    <div class="timeline-item" data-time="11:01"><div class="timeline-time">11:01</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">Ê¢ÖÂ∞èË∑ØÂÖ¨Âúí„ÉªJRÊ¢ÖÂ∞èË∑Ø‰∫¨ÈÉΩË•øÈßÖÂâç„Éê„ÇπÂá∫Áô∫</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">Â∏Ç„Éê„Çπ208</div><div class="card-bottom"><span class="card-cost">¬•230</span></div></div></div>
    <div class="timeline-item" data-time="11:30"><div class="timeline-time">11:30</div><div class="timeline-dot sight"></div><span class="now-label">üìç NOW</span><div class="timeline-card sight"><div class="card-header"><div class="card-title">Êù±Á¶èÂØ∫</div><span class="card-category sight">Ë¶≥ÂÖâ</span></div><div class="card-detail">ÊãùË¶≥Êñô Â§ß‰∫∫1,000ÂÜÜ / ‰∏≠‰∫∫500ÂÜÜ</div><div class="card-photo-wrap"><span class="card-photo-placeholder">‚õ©</span><img class="card-photo" src="https://images.unsplash.com/photo-1601823984263-b87b59798b70?w=600&h=280&fit=crop&q=80" alt="Êù±Á¶èÂØ∫" loading="lazy" onerror="this.style.display='none'" onload="this.classList.add('loaded');var p=this.previousElementSibling;if(p)p.style.display='none'"></div><div class="card-bottom"><span class="card-cost">¬•1,000</span><a href="https://maps.google.com/maps?q=Êù±Á¶èÂØ∫+‰∫¨ÈÉΩ" target="_blank" rel="noopener" class="card-link">üìç MAP</a><a href="https://tofukuji.jp/" target="_blank" rel="noopener" class="card-link site-link">üîó ÂÖ¨Âºè</a></div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± JRÂ•àËâØÁ∑ö Á¥Ñ20ÂàÜ</div></div>
    <div class="timeline-item" data-time="12:18"><div class="timeline-time">12:18</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">Êù±Á¶èÂØ∫ÈßÖÂá∫Áô∫</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">JRÂ•àËâØÁ∑ö 2Áï™Á∑ö</div><div class="card-bottom"><span class="card-cost">¬•240</span></div></div></div>
    <div class="timeline-item" data-time="12:37"><div class="timeline-time">12:37</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">ÂÆáÊ≤ªÈßÖÁùÄ</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">ÂæíÊ≠©12ÂàÜ</div><div class="card-bottom"><a href="https://maps.google.com/maps?q=ÂÆáÊ≤ªÈßÖ" target="_blank" rel="noopener" class="card-link">üìç MAP</a></div></div></div>
    <div class="timeline-item" data-time="12:50"><div class="timeline-time">12:50</div><div class="timeline-dot food"></div><span class="now-label">üìç NOW</span><div class="timeline-card food"><div class="card-header"><div class="card-title">ËìÆËèØËå∂Â±ãÔºà„É©„É≥„ÉÅÔºâ</div><span class="card-category food">È£ü‰∫ã</span></div><div class="card-detail">Âπ≥Á≠âÈô¢„Åæ„ÅßÂæíÊ≠©4ÂàÜ</div><div class="card-bottom"><a href="https://maps.google.com/maps?q=ËìÆËèØËå∂Â±ã+ÂÆáÊ≤ª" target="_blank" rel="noopener" class="card-link">üìç MAP</a></div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± ÂæíÊ≠© 4ÂàÜ</div></div>
    <div class="timeline-item" data-time="14:15"><div class="timeline-time">14:15</div><div class="timeline-dot sight"></div><span class="now-label">üìç NOW</span><div class="timeline-card sight"><div class="card-header"><div class="card-title">Âπ≥Á≠âÈô¢È≥≥Âá∞Â†Ç</div><span class="card-category sight">Ë¶≥ÂÖâ</span></div><div class="card-detail">ÊãùË¶≥Êñô Â§ß‰∫∫700ÂÜÜ / ‰∏≠‰∫∫400ÂÜÜ</div><div class="card-photo-wrap"><span class="card-photo-placeholder">üèõ</span><img class="card-photo" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/69/Phoenix_Hall%2C_Byodo-in%2C_November_2016_-01.jpg/600px-Phoenix_Hall%2C_Byodo-in%2C_November_2016_-01.jpg" alt="Âπ≥Á≠âÈô¢È≥≥Âá∞Â†Ç" loading="lazy" onerror="this.style.display='none'" onload="this.classList.add('loaded');var p=this.previousElementSibling;if(p)p.style.display='none'"></div><div class="card-bottom"><span class="card-cost">¬•700</span><a href="https://maps.google.com/maps?q=Âπ≥Á≠âÈô¢È≥≥Âá∞Â†Ç" target="_blank" rel="noopener" class="card-link">üìç MAP</a><a href="https://www.byodoin.or.jp/" target="_blank" rel="noopener" class="card-link site-link">üîó ÂÖ¨Âºè</a></div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± JRÂ•àËâØÁ∑ö Á¥Ñ25ÂàÜ</div></div>
    <div class="timeline-item" data-time="15:07"><div class="timeline-time">15:07</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">ÂÆáÊ≤ªÈßÖÂá∫Áô∫</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">JRÂ•àËâØÁ∑ö 1„Éª2Áï™Á∑ö</div><div class="card-bottom"><span class="card-cost">¬•240</span></div></div></div>
    <div class="timeline-item" data-time="15:30"><div class="timeline-time">15:30</div><div class="timeline-dot sight"></div><span class="now-label">üìç NOW</span><div class="timeline-card sight"><div class="card-header"><div class="card-title">‰ºèË¶ãÁ®≤Ëç∑Â§ßÁ§æ</div><span class="card-category sight">Ë¶≥ÂÖâ</span></div><div class="card-photo-wrap"><span class="card-photo-placeholder">‚õ©</span><img class="card-photo" src="https://images.unsplash.com/photo-1478436127897-769e1b3f0f36?w=600&h=280&fit=crop&q=80" alt="‰ºèË¶ãÁ®≤Ëç∑Â§ßÁ§æ" loading="lazy" onerror="this.style.display='none'" onload="this.classList.add('loaded');var p=this.previousElementSibling;if(p)p.style.display='none'"></div><div class="card-bottom"><a href="https://maps.google.com/maps?q=‰ºèË¶ãÁ®≤Ëç∑Â§ßÁ§æ" target="_blank" rel="noopener" class="card-link">üìç MAP</a><a href="https://inari.jp/" target="_blank" rel="noopener" class="card-link site-link">üîó ÂÖ¨Âºè</a></div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± ‰∫¨Èò™+ÂæíÊ≠© Á¥Ñ20ÂàÜ</div></div>
    <div class="timeline-item" data-time="16:49"><div class="timeline-time">16:49</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">‰ºèË¶ãÁ®≤Ëç∑ÈßÖÂá∫Áô∫</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">‰∫¨Èò™Êú¨Á∑ö 1Áï™Á∑ö<br>Á•áÂúíÂõõÊù°ÈßÖÁùÄ 16:58 ‚ñ∂ ÂæíÊ≠©10ÂàÜ</div><div class="card-bottom"><span class="card-cost">¬•240</span></div></div></div>
    <div class="timeline-item" data-time="17:15"><div class="timeline-time">17:15</div><div class="timeline-dot food"></div><span class="now-label">üìç NOW</span><div class="timeline-card food"><div class="card-header"><div class="card-title">Á•áÂúí„Åç„Çà„Åø„ÅöÁ•á„Çí„ÇìÊñ∞Ê©ãÔºàÂ§ïÈ£ØÔºâ</div><span class="card-category food">È£ü‰∫ã</span></div><div class="card-detail">„Ç≥„Éº„Çπ5,000ÂÜÜ<br>„Éê„Çπ„Åæ„ÅßÂæíÊ≠©6ÂàÜ</div><div class="card-bottom"><span class="card-cost">¬•5,000</span><span class="card-reserved">‚úì ‰∫àÁ¥ÑÊ∏à</span><a href="https://maps.google.com/maps?q=Á•á„Çí„ÇìÊñ∞Ê©ã+‰∫¨ÈÉΩ" target="_blank" rel="noopener" class="card-link">üìç MAP</a></div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± „Éê„Çπ Á¥Ñ30ÂàÜ</div></div>
    <div class="timeline-item" data-time="19:46"><div class="timeline-time">19:46</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">Á•áÂúí„Éê„Çπ</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">Â∏Ç„Éê„Çπ207</div><div class="card-bottom"><span class="card-cost">¬•230</span></div></div></div>
    <div class="timeline-item" data-time="20:15"><div class="timeline-time">20:15</div><div class="timeline-dot sight"></div><span class="now-label">üìç NOW</span><div class="timeline-card sight"><div class="card-header"><div class="card-title">Êù±ÂØ∫ÔºàÂ§úÊ°ú„É©„Ç§„Éà„Ç¢„ÉÉ„ÉóÔºâ</div><span class="card-category sight">Ë¶≥ÂÖâ</span></div><div class="card-detail">Â§ß‰∫∫1,000ÂÜÜ / ‰∏≠‰∫∫500ÂÜÜ</div><div class="card-photo-wrap"><span class="card-photo-placeholder">üåô</span><img class="card-photo" src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/75/Cherry_Trees_in_the_Night_%2826870722875%29.jpg/600px-Cherry_Trees_in_the_Night_%2826870722875%29.jpg" alt="Êù±ÂØ∫" loading="lazy" onerror="this.style.display='none'" onload="this.classList.add('loaded');var p=this.previousElementSibling;if(p)p.style.display='none'"></div><div class="card-bottom"><span class="card-cost">¬•1,000</span><a href="https://maps.google.com/maps?q=Êù±ÂØ∫+‰∫¨ÈÉΩ" target="_blank" rel="noopener" class="card-link">üìç MAP</a></div></div></div>
    <div class="timeline-item" data-time="21:30"><div class="timeline-time">21:30</div><div class="timeline-dot hotel"></div><span class="now-label">üìç NOW</span><div class="timeline-card hotel"><div class="card-header"><div class="card-title">„Éõ„ÉÜ„É´„Ç®„Éü„Ç™„É≥‰∫¨ÈÉΩ ÂÆøÊ≥ä</div><span class="card-category hotel">ÂÆøÊ≥ä</span></div></div></div>
    <div class="day-subtotal"><div class="day-subtotal-inner">Day 1 Â∞èË®à <span class="day-subtotal-amount" id="sub1">‚Äî</span></div></div>
    <div class="day-map-link"><a href="https://www.google.com/maps/dir/ÁÜäË∞∑ÈßÖ/Êù±‰∫¨ÈßÖ/‰∫¨ÈÉΩÈßÖ/„Éõ„ÉÜ„É´„Ç®„Éü„Ç™„É≥‰∫¨ÈÉΩ/Êù±Á¶èÂØ∫/ÂÆáÊ≤ª+Âπ≥Á≠âÈô¢È≥≥Âá∞Â†Ç/‰ºèË¶ãÁ®≤Ëç∑Â§ßÁ§æ/Á•áÂúíÂõõÊù°/Êù±ÂØ∫" target="_blank" rel="noopener">üó∫ Day 1 „ÅÆ„É´„Éº„Éà„ÇíMaps„ÅßË¶ã„Çã</a></div>
  </div>
</section>

<!-- DAY 2 -->
<section class="content-section" id="day2">
  <div class="day-header"><div class="day-number" lang="en">Day 2</div><div class="day-date">3/15</div><div class="day-weekday">Êó•ÊõúÊó•</div></div>
  <div class="timeline" data-day="2026-03-15">
    <div class="timeline-item" data-time="09:20"><div class="timeline-time">09:20</div><div class="timeline-dot hotel"></div><span class="now-label">üìç NOW</span><div class="timeline-card hotel"><div class="card-header"><div class="card-title">„Éõ„ÉÜ„É´„Ç®„Éü„Ç™„É≥‰∫¨ÈÉΩÂá∫Áô∫</div><span class="card-category hotel">ÂÆøÊ≥ä</span></div><div class="card-detail">ÂæíÊ≠©10ÂàÜ</div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± ÂæíÊ≠©+„Éê„Çπ Á¥Ñ45ÂàÜ</div></div>
    <div class="timeline-item" data-time="09:37"><div class="timeline-time">09:37</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">‰∏ÉÊù°Â§ßÂÆÆ„Éª‰∫¨ÈÉΩÊ∞¥ÊóèÈ§®Ââç„Éê„ÇπÂá∫Áô∫</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">È´òÈõÑ‰∫¨ÂåóÁ∑ö</div><div class="card-bottom"><span class="card-cost">¬•230</span></div></div></div>
    <div class="timeline-item" data-time="10:06"><div class="timeline-time">10:06</div><div class="timeline-dot sight"></div><span class="now-label">üìç NOW</span><div class="timeline-card sight"><div class="card-header"><div class="card-title">ÈæçÂÆâÂØ∫</div><span class="card-category sight">Ë¶≥ÂÖâ</span></div><div class="card-detail">ÊãùË¶≥Êñô Â§ß‰∫∫600ÂÜÜ / ‰∏≠‰∫∫300ÂÜÜ</div><div class="card-photo-wrap"><span class="card-photo-placeholder">ü™®</span><img class="card-photo" src="https://images.unsplash.com/photo-1576675466969-38eeae4b41f6?w=600&h=280&fit=crop&q=80" alt="ÈæçÂÆâÂØ∫" loading="lazy" onerror="this.style.display='none'" onload="this.classList.add('loaded');var p=this.previousElementSibling;if(p)p.style.display='none'"></div><div class="card-bottom"><span class="card-cost">¬•600</span><a href="https://maps.google.com/maps?q=ÈæçÂÆâÂØ∫+‰∫¨ÈÉΩ" target="_blank" rel="noopener" class="card-link">üìç MAP</a><a href="https://www.ryoanji.jp/" target="_blank" rel="noopener" class="card-link site-link">üîó ÂÖ¨Âºè</a></div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± „Éê„Çπ Á¥Ñ10ÂàÜ</div></div>
    <div class="timeline-item" data-time="10:57"><div class="timeline-time">10:57</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">ÈæçÂÆâÂØ∫Ââç„Éê„ÇπÂá∫Áô∫</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">Â∏Ç„Éê„Çπ59</div><div class="card-bottom"><span class="card-cost">¬•230</span></div></div></div>
    <div class="timeline-item" data-time="11:06"><div class="timeline-time">11:06</div><div class="timeline-dot sight"></div><span class="now-label">üìç NOW</span><div class="timeline-card sight"><div class="card-header"><div class="card-title">ÈáëÈñ£ÂØ∫</div><span class="card-category sight">Ë¶≥ÂÖâ</span></div><div class="card-detail">ÊãùË¶≥Êñô Â§ß‰∫∫500ÂÜÜ / ‰∏≠‰∫∫300ÂÜÜ</div><div class="card-photo-wrap"><span class="card-photo-placeholder">üèØ</span><img class="card-photo" src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/Kinkaku-ji_the_Golden_Temple_in_Kyoto_overlooking_the_lake_-_high_rez.JPG/600px-Kinkaku-ji_the_Golden_Temple_in_Kyoto_overlooking_the_lake_-_high_rez.JPG" alt="ÈáëÈñ£ÂØ∫" loading="lazy" onerror="this.onerror=function(){this.style.display='none'};this.src='https://upload.wikimedia.org/wikipedia/commons/thumb/4/4e/Kinkaku-ji_2015.JPG/600px-Kinkaku-ji_2015.JPG'" onload="this.classList.add('loaded');var p=this.previousElementSibling;if(p)p.style.display='none'"></div><div class="card-bottom"><span class="card-cost">¬•500</span><a href="https://maps.google.com/maps?q=ÈáëÈñ£ÂØ∫" target="_blank" rel="noopener" class="card-link">üìç MAP</a><a href="https://www.shokoku-ji.jp/kinkakuji/" target="_blank" rel="noopener" class="card-link site-link">üîó ÂÖ¨Âºè</a></div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± „Éê„Çπ Á¥Ñ40ÂàÜ</div></div>
    <div class="timeline-item" data-time="12:10"><div class="timeline-time">12:10</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">ÈáëÈñ£ÂØ∫Ââç„Éê„Çπ</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">Â∏Ç„Éê„Çπ102</div><div class="card-bottom"><span class="card-cost">¬•230</span></div></div></div>
    <div class="timeline-item" data-time="12:52"><div class="timeline-time">12:52</div><div class="timeline-dot sight"></div><span class="now-label">üìç NOW</span><div class="timeline-card sight"><div class="card-header"><div class="card-title">ÈäÄÈñ£ÂØ∫</div><span class="card-category sight">Ë¶≥ÂÖâ</span></div><div class="card-detail">ÊãùË¶≥Êñô Â§ß‰∫∫500ÂÜÜ / ‰∏≠‰∫∫300ÂÜÜ<br>È£ü„ÅπÊ≠©„ÅçÔºöÈäÄ„Ç≥„É≠„ÉÉ„Ç±„Éª„Åü„Å∞„Å≠„ÅÆ„ÅóÂ∫ó„ÅÆ„ÇØ„É¨„Éº„Éó„ÉªÊú¨ÂÆ∂ÂÖ´Ê©ãÂ∫ó„ÅÆÁîüÂÖ´Ê©ã</div><div class="card-photo-wrap"><span class="card-photo-placeholder">üèØ</span><img class="card-photo" src="https://images.unsplash.com/photo-1545569341-9eb8b30979d9?w=600&h=280&fit=crop&q=80" alt="ÈäÄÈñ£ÂØ∫" loading="lazy" onerror="this.style.display='none'" onload="this.classList.add('loaded');var p=this.previousElementSibling;if(p)p.style.display='none'"></div><div class="card-bottom"><span class="card-cost">¬•500</span><a href="https://maps.google.com/maps?q=ÈäÄÈñ£ÂØ∫" target="_blank" rel="noopener" class="card-link">üìç MAP</a><a href="https://www.shokoku-ji.jp/ginkakuji/" target="_blank" rel="noopener" class="card-link site-link">üîó ÂÖ¨Âºè</a></div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± Ë¶≥ÂÖâÁâπÊÄ•„Éê„Çπ Á¥Ñ20ÂàÜ</div></div>
    <div class="timeline-item" data-time="14:15"><div class="timeline-time">14:15</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">ÈäÄÈñ£ÂØ∫Ââç„Éê„Çπ</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">Â∏Ç„Éê„ÇπË¶≥ÂÖâÁâπÊÄ•EX100</div><div class="card-bottom"><span class="card-cost">¬•500</span></div></div></div>
    <div class="timeline-item" data-time="14:33"><div class="timeline-time">14:33</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">Ê∏ÖÊ∞¥ÈÅìÁùÄ</div><span class="card-category transport">ÁßªÂãï</span></div></div></div>
    <div class="timeline-item" data-time="14:40"><div class="timeline-time">14:40</div><div class="timeline-dot sight"></div><span class="now-label">üìç NOW</span><div class="timeline-card sight"><div class="card-header"><div class="card-title">ÂÖ´ÂùÇÂ∫öÁî≥Â†Ç„ÉªÊ∏ÖÊ∞¥ÂØ∫ÔºàÈ£ü„ÅπÊ≠©„ÅçÔºâ</div><span class="card-category sight">Ë¶≥ÂÖâ</span></div><div class="card-detail">Ê∏ÖÊ∞¥ÂØ∫ÊãùË¶≥Êñô Â§ß‰∫∫500ÂÜÜ / ‰∏≠‰∫∫200ÂÜÜ<br>„ÅäÂúüÁî£Ôºö„Åµ„Çè„Åµ„Çè„Åä„Åü„Åπ„Éª„Éï„Ç£„Éä„É≥„Ç∑„Çß<br>È£ü„ÅπÊ≠©„ÅçÔºö„Ç≥„ÇØ„É™„É≥„Éó„É©„É≥Ôºà„ÇØ„É≠„ÉØ„ÉÉ„Çµ„É≥Ôºâ„ÄÅ„Ç¥„Ç´„Ç¥ÔºàÊäπËå∂„É©„ÉÜÔºâ</div><div class="card-photo-wrap"><span class="card-photo-placeholder">üåä</span><img class="card-photo" src="https://images.unsplash.com/photo-1493976040374-85c8e12f0c0e?w=600&h=280&fit=crop&q=80" alt="Ê∏ÖÊ∞¥ÂØ∫" loading="lazy" onerror="this.style.display='none'" onload="this.classList.add('loaded');var p=this.previousElementSibling;if(p)p.style.display='none'"></div><div class="card-bottom"><span class="card-cost">¬•500</span><a href="https://maps.google.com/maps?q=Ê∏ÖÊ∞¥ÂØ∫+‰∫¨ÈÉΩ" target="_blank" rel="noopener" class="card-link">üìç MAP</a><a href="https://www.kiyomizudera.or.jp/" target="_blank" rel="noopener" class="card-link site-link">üîó ÂÖ¨Âºè</a></div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± „Éê„Çπ Á¥Ñ30ÂàÜ</div></div>
    <div class="timeline-item" data-time="17:27"><div class="timeline-time">17:27</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">Ê∏ÖÊ∞¥ÈÅìÂá∫Áô∫</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">Â∏Ç„Éê„Çπ207</div><div class="card-bottom"><span class="card-cost">¬•230</span></div></div></div>
    <div class="timeline-item" data-time="18:30"><div class="timeline-time">18:30</div><div class="timeline-dot food"></div><span class="now-label">üìç NOW</span><div class="timeline-card food"><div class="card-header"><div class="card-title">‰∫¨ÈÉΩÁÇ≠ÁÅ´‰∏≤ÁÑº„Å§„Åò„ÇÑÔºàÂ§ïÈ£ØÔºâ</div><span class="card-category food">È£ü‰∫ã</span></div><div class="card-detail">È£≤„ÅøÊîæÈ°å‰ªò„Åç</div><div class="card-bottom"><span class="card-cost">¬•5,000</span><a href="https://maps.google.com/maps?q=‰∫¨ÈÉΩÁÇ≠ÁÅ´‰∏≤ÁÑº„Å§„Åò„ÇÑ" target="_blank" rel="noopener" class="card-link">üìç MAP</a></div></div></div>
    <div class="timeline-item" data-time="21:00"><div class="timeline-time">21:00</div><div class="timeline-dot hotel"></div><span class="now-label">üìç NOW</span><div class="timeline-card hotel"><div class="card-header"><div class="card-title">„Éõ„ÉÜ„É´„Ç®„Éü„Ç™„É≥‰∫¨ÈÉΩÁùÄ</div><span class="card-category hotel">ÂÆøÊ≥ä</span></div></div></div>
    <div class="day-subtotal"><div class="day-subtotal-inner">Day 2 Â∞èË®à <span class="day-subtotal-amount" id="sub2">‚Äî</span></div></div>
    <div class="day-map-link"><a href="https://www.google.com/maps/dir/„Éõ„ÉÜ„É´„Ç®„Éü„Ç™„É≥‰∫¨ÈÉΩ/ÈæçÂÆâÂØ∫/ÈáëÈñ£ÂØ∫/ÈäÄÈñ£ÂØ∫/Ê∏ÖÊ∞¥ÂØ∫/‰∫¨ÈÉΩÁÇ≠ÁÅ´‰∏≤ÁÑº„Å§„Åò„ÇÑ" target="_blank" rel="noopener">üó∫ Day 2 „ÅÆ„É´„Éº„Éà„ÇíMaps„ÅßË¶ã„Çã</a></div>
  </div>
</section>

<!-- DAY 3 -->
<section class="content-section" id="day3">
  <div class="day-header"><div class="day-number" lang="en">Day 3</div><div class="day-date">3/16</div><div class="day-weekday">ÊúàÊõúÊó•</div></div>
  <div class="timeline" data-day="2026-03-16">
    <div class="timeline-item" data-time="09:00"><div class="timeline-time">09:00</div><div class="timeline-dot hotel"></div><span class="now-label">üìç NOW</span><div class="timeline-card hotel"><div class="card-header"><div class="card-title">„Éõ„ÉÜ„É´„Ç®„Éü„Ç™„É≥‰∫¨ÈÉΩÂá∫Áô∫</div><span class="card-category hotel">ÂÆøÊ≥ä</span></div><div class="card-detail">ÂæíÊ≠©</div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± JRÂ±±Èô∞Êú¨Á∑ö Á¥Ñ15ÂàÜ</div></div>
    <div class="timeline-item" data-time="09:12"><div class="timeline-time">09:12</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">Ê¢ÖÂ∞èË∑Ø‰∫¨ÈÉΩË•øÈßÖÂá∫Áô∫</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">Â±±Èô∞Êú¨Á∑ö</div><div class="card-bottom"><span class="card-cost">¬•200</span></div></div></div>
    <div class="timeline-item" data-time="09:26"><div class="timeline-time">09:26</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">ÂµØÂ≥®ÂµêÂ±±ÈßÖÁùÄ</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">ÂæíÊ≠©10ÂàÜ</div><div class="card-bottom"><a href="https://maps.google.com/maps?q=ÂµØÂ≥®ÂµêÂ±±ÈßÖ" target="_blank" rel="noopener" class="card-link">üìç MAP</a></div></div></div>
    <div class="timeline-item" data-time="09:35"><div class="timeline-time">09:35</div><div class="timeline-dot sight"></div><span class="now-label">üìç NOW</span><div class="timeline-card sight"><div class="card-header"><div class="card-title">Â§©ÈæçÂØ∫„ÉªÊ∏°ÊúàÊ©ã</div><span class="card-category sight">Ë¶≥ÂÖâ</span></div><div class="card-detail">Â§©ÈæçÂØ∫ÔºöÂ∫≠ÂúíÔºÜÊ≥ïÂ†Ç<br>Â§ß‰∫∫1,000ÂÜÜ / ‰∏≠‰∫∫800ÂÜÜ</div><div class="card-photo-wrap"><span class="card-photo-placeholder">üéã</span><img class="card-photo" src="https://images.unsplash.com/photo-1528360983277-13d401cdc186?w=600&h=280&fit=crop&q=80" alt="ÂµêÂ±±" loading="lazy" onerror="this.style.display='none'" onload="this.classList.add('loaded');var p=this.previousElementSibling;if(p)p.style.display='none'"></div><div class="card-bottom"><span class="card-cost">¬•1,000</span><a href="https://maps.google.com/maps?q=Â§©ÈæçÂØ∫+‰∫¨ÈÉΩ" target="_blank" rel="noopener" class="card-link">üìç MAP</a><a href="https://www.tenryuji.com/" target="_blank" rel="noopener" class="card-link site-link">üîó ÂÖ¨Âºè</a></div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± JRÂ±±Èô∞Êú¨Á∑ö Á¥Ñ15ÂàÜ</div></div>
    <div class="timeline-item" data-time="11:02"><div class="timeline-time">11:02</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">ÂµØÂ≥®ÂµêÂ±±ÈßÖÂá∫Áô∫</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">Â±±Èô∞Êú¨Á∑ö</div><div class="card-bottom"><span class="card-cost">¬•200</span></div></div></div>
    <div class="timeline-item" data-time="11:17"><div class="timeline-time">11:17</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">Ê¢ÖÂ∞èË∑Ø‰∫¨ÈÉΩË•øÈßÖÁùÄ</div><span class="card-category transport">ÁßªÂãï</span></div></div></div>
    <div class="timeline-item" data-time="11:30"><div class="timeline-time">11:30</div><div class="timeline-dot hotel"></div><span class="now-label">üìç NOW</span><div class="timeline-card hotel"><div class="card-header"><div class="card-title">„Éõ„ÉÜ„É´„Ç®„Éü„Ç™„É≥‰∫¨ÈÉΩ</div><span class="card-category hotel">ÂÆøÊ≥ä</span></div><div class="card-detail">„Çπ„Éº„ÉÑ„Ç±„Éº„ÇπÂèñ„Çä„Å´Ë°å„Åè</div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± JRÂ±±Èô∞Êú¨Á∑ö 5ÂàÜ</div></div>
    <div class="timeline-item" data-time="12:17"><div class="timeline-time">12:17</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">Ê¢ÖÂ∞èË∑Ø‰∫¨ÈÉΩË•øÈßÖÂá∫Áô∫</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">Â±±Èô∞Êú¨Á∑ö</div><div class="card-bottom"><span class="card-cost">¬•150</span></div></div></div>
    <div class="timeline-item" data-time="12:20"><div class="timeline-time">12:20</div><div class="timeline-dot food"></div><span class="now-label">üìç NOW</span><div class="timeline-card food"><div class="card-header"><div class="card-title">‰∫¨ÈÉΩÈßÖÁùÄÔºà„É©„É≥„ÉÅ„Éª„ÅäÂúüÁî£Ôºâ</div><span class="card-category food">È£ü‰∫ã</span></div><div class="card-detail">„É©„É≥„ÉÅÔºö‰∫¨ÈÉΩÊú¨ÂÆ∂ Á¨¨‰∏ÄÊó≠ Êú¨Â∫ó„É©„Éº„É°„É≥<br>„ÅäÂúüÁî£Ôºö„Ç∏„Çß„Ç§„Ç¢„Éº„É´‰∫¨ÈÉΩ‰ºäÂã¢‰∏πÔºàÈòøÈóçÊ¢®È§ÖÔºâ</div><div class="card-bottom"><a href="https://maps.google.com/maps?q=Á¨¨‰∏ÄÊó≠+Êú¨Â∫ó+‰∫¨ÈÉΩ" target="_blank" rel="noopener" class="card-link">üìç MAP</a></div></div></div>
    <div class="duration-badge"><div class="duration-badge-inner">‚è± „Å≤„Åã„Çä Á¥Ñ2ÊôÇÈñì36ÂàÜ</div></div>
    <div class="timeline-item" data-time="14:33"><div class="timeline-time">14:33</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">‰∫¨ÈÉΩÈßÖÂá∫Áô∫</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">JR„Å≤„Åã„Çä654Âè∑<br>12Âè∑Ëªä20Áï™ABCDEÂ∏≠</div>
<div class="seat-chart">
<div class="seat-chart-title">üöÖ Â∫ßÂ∏≠Ë°® ‚Äî 12Âè∑Ëªä 20Áï™ABCDE</div>
<div class="seat-train-dir"><span>‚Üê ÂçöÂ§öÊñπÈù¢</span><span>Êù±‰∫¨ÊñπÈù¢ ‚Üí</span></div>
<div class="seat-train-cars">
<div class="seat-train-car">1</div><div class="seat-train-car">2</div><div class="seat-train-car">3</div><div class="seat-train-car">4</div><div class="seat-train-car">5</div><div class="seat-train-car">6</div><div class="seat-train-car">7</div><div class="seat-train-car green">8</div><div class="seat-train-car green">9</div><div class="seat-train-car green">10</div><div class="seat-train-car">11</div><div class="seat-train-car ours">12</div><div class="seat-train-car">13</div><div class="seat-train-car">14</div><div class="seat-train-car">15</div><div class="seat-train-car">16</div>
</div>
<div class="seat-layout">
<div class="seat-layout-title">12Âè∑Ëªä Â∫ßÂ∏≠ÈÖçÁΩÆ</div>
<div class="seat-layout-dir">‚Üë ÂçöÂ§öÂØÑ„ÇäÔºàÂâçÊñπÔºâ</div>
<div class="seat-col-header">
<div class="seat-col-num-spacer"></div>
<div class="seat-col-label">A</div><div class="seat-col-label">B</div><div class="seat-col-label">C</div>
<div class="seat-col-aisle"></div>
<div class="seat-col-label">D</div><div class="seat-col-label">E</div>
</div>
<div class="seat-row"><div class="seat-row-num">18</div><div class="seat-cell">A</div><div class="seat-cell">B</div><div class="seat-cell">C</div><div class="seat-aisle"></div><div class="seat-cell">D</div><div class="seat-cell">E</div></div>
<div class="seat-row"><div class="seat-row-num">19</div><div class="seat-cell">A</div><div class="seat-cell">B</div><div class="seat-cell">C</div><div class="seat-aisle"></div><div class="seat-cell">D</div><div class="seat-cell">E</div></div>
<div class="seat-row"><div class="seat-row-num">20</div><div class="seat-cell ours">A</div><div class="seat-cell ours">B</div><div class="seat-cell ours">C</div><div class="seat-aisle"></div><div class="seat-cell ours">D</div><div class="seat-cell ours">E</div></div>
<div class="seat-layout-dir">‚Üì Êù±‰∫¨ÂØÑ„ÇäÔºàÂæåÊñπÔºâ</div>
</div>
<div class="seat-legend">
<div class="seat-legend-item"><div class="seat-legend-box ours"></div> Ëá™ÂàÜ„Åü„Å°„ÅÆÂ∏≠</div>
<div class="seat-legend-item"><div class="seat-legend-box green"></div> „Ç∞„É™„Éº„É≥Ëªä</div>
</div>
</div><div class="card-bottom"><a href="https://maps.google.com/maps?q=‰∫¨ÈÉΩÈßÖ+Êñ∞ÂππÁ∑ö" target="_blank" rel="noopener" class="card-link">üìç MAP</a></div></div></div>
    <div class="timeline-item" data-time="17:09"><div class="timeline-time">17:09</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">Êù±‰∫¨ÈßÖÁùÄ</div><span class="card-category transport">ÁßªÂãï</span></div></div></div>
    <div class="timeline-item" data-time="17:40"><div class="timeline-time">17:40</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">Êù±‰∫¨ÈßÖÂá∫Áô∫</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">JR„ÅÇ„Åï„Åæ623Âè∑ 23Áï™Á∑ö</div></div></div>
    <div class="timeline-item" data-time="18:17"><div class="timeline-time">18:17</div><div class="timeline-dot transport"></div><span class="now-label">üìç NOW</span><div class="timeline-card transport"><div class="card-header"><div class="card-title">ÁÜäË∞∑ÈßÖÁùÄ üè†</div><span class="card-category transport">ÁßªÂãï</span></div><div class="card-detail">„Åä„Å§„Åã„Çå„Åï„Åæ„Åß„Åó„ÅüÔºÅ</div></div></div>
    <div class="day-subtotal"><div class="day-subtotal-inner">Day 3 Â∞èË®à <span class="day-subtotal-amount" id="sub3">‚Äî</span></div></div>
    <div class="day-map-link"><a href="https://www.google.com/maps/dir/„Éõ„ÉÜ„É´„Ç®„Éü„Ç™„É≥‰∫¨ÈÉΩ/Â§©ÈæçÂØ∫/ÂµØÂ≥®ÂµêÂ±±ÈßÖ/‰∫¨ÈÉΩÈßÖ/Êù±‰∫¨ÈßÖ/ÁÜäË∞∑ÈßÖ" target="_blank" rel="noopener">üó∫ Day 3 „ÅÆ„É´„Éº„Éà„ÇíMaps„ÅßË¶ã„Çã</a></div>
  </div>
</section>

<footer class="footer">
  <div class="footer-title">‰∫¨ÈÉΩ 2026</div>
  <div class="footer-sub">ËâØ„ÅÑÊóÖ„Å´„Å™„Çä„Åæ„Åô„Çà„ÅÜ„Å´</div>
  <div class="footer-sakura">üå∏</div>
</footer>

<!-- Cost Modal -->
<div class="modal-overlay" id="costModal">
  <div class="modal">
    <div class="modal-title"><span>üí∞ Ë≤ªÁî®Ê¶ÇÁÆóÔºàÂ§ß‰∫∫1‰∫∫ÂàÜÔºâ</span><button class="modal-close" id="costModalClose">&times;</button></div>
    <div class="cost-day-title">Day 1 ‚Äî 3/14ÔºàÂúüÔºâ</div>
    <div class="cost-row"><span>JRÂµØÂ≥®ÈáéÁ∑ö</span><span class="cost-row-amount">¬•150</span></div>
    <div class="cost-row"><span>„Éê„Çπ1Êó•Âà∏</span><span class="cost-row-amount">¬•1,100</span></div>
    <div class="cost-row"><span>Â∏Ç„Éê„Çπ208</span><span class="cost-row-amount">¬•230</span></div>
    <div class="cost-row"><span>Êù±Á¶èÂØ∫ ÊãùË¶≥Êñô</span><span class="cost-row-amount">¬•1,000</span></div>
    <div class="cost-row"><span>JRÂ•àËâØÁ∑öÔºàÊù±Á¶èÂØ∫‚ÜíÂÆáÊ≤ªÔºâ</span><span class="cost-row-amount">¬•240</span></div>
    <div class="cost-row"><span>Âπ≥Á≠âÈô¢È≥≥Âá∞Â†Ç</span><span class="cost-row-amount">¬•700</span></div>
    <div class="cost-row"><span>JRÂ•àËâØÁ∑öÔºàÂÆáÊ≤ª‚ÜíÁ®≤Ëç∑Ôºâ</span><span class="cost-row-amount">¬•240</span></div>
    <div class="cost-row"><span>‰∫¨Èò™Êú¨Á∑ö</span><span class="cost-row-amount">¬•240</span></div>
    <div class="cost-row"><span>Á•áÂúí„Åç„Çà„Åø„Åö Â§ïÈ£Ø</span><span class="cost-row-amount">¬•5,000</span></div>
    <div class="cost-row"><span>Â∏Ç„Éê„Çπ207</span><span class="cost-row-amount">¬•230</span></div>
    <div class="cost-row"><span>Êù±ÂØ∫ „É©„Ç§„Éà„Ç¢„ÉÉ„Éó</span><span class="cost-row-amount">¬•1,000</span></div>
    <div class="cost-day-sub"><span>Day 1 Â∞èË®à</span><span id="modalSub1">‚Äî</span></div>
    <div class="cost-day-title">Day 2 ‚Äî 3/15ÔºàÊó•Ôºâ</div>
    <div class="cost-row"><span>È´òÈõÑ‰∫¨ÂåóÁ∑ö„Éê„Çπ</span><span class="cost-row-amount">¬•230</span></div>
    <div class="cost-row"><span>ÈæçÂÆâÂØ∫ ÊãùË¶≥Êñô</span><span class="cost-row-amount">¬•600</span></div>
    <div class="cost-row"><span>Â∏Ç„Éê„Çπ59</span><span class="cost-row-amount">¬•230</span></div>
    <div class="cost-row"><span>ÈáëÈñ£ÂØ∫ ÊãùË¶≥Êñô</span><span class="cost-row-amount">¬•500</span></div>
    <div class="cost-row"><span>Â∏Ç„Éê„Çπ102</span><span class="cost-row-amount">¬•230</span></div>
    <div class="cost-row"><span>ÈäÄÈñ£ÂØ∫ ÊãùË¶≥Êñô</span><span class="cost-row-amount">¬•500</span></div>
    <div class="cost-row"><span>Â∏Ç„Éê„ÇπË¶≥ÂÖâÁâπÊÄ•EX100</span><span class="cost-row-amount">¬•500</span></div>
    <div class="cost-row"><span>Ê∏ÖÊ∞¥ÂØ∫ ÊãùË¶≥Êñô</span><span class="cost-row-amount">¬•500</span></div>
    <div class="cost-row"><span>Â∏Ç„Éê„Çπ207</span><span class="cost-row-amount">¬•230</span></div>
    <div class="cost-row"><span>‰∫¨ÈÉΩÁÇ≠ÁÅ´‰∏≤ÁÑº„Å§„Åò„ÇÑ</span><span class="cost-row-amount">¬•5,000</span></div>
    <div class="cost-day-sub"><span>Day 2 Â∞èË®à</span><span id="modalSub2">‚Äî</span></div>
    <div class="cost-day-title">Day 3 ‚Äî 3/16ÔºàÊúàÔºâ</div>
    <div class="cost-row"><span>Â±±Èô∞Êú¨Á∑öÔºàÊ¢ÖÂ∞èË∑Ø‚ÜíÂµêÂ±±Ôºâ</span><span class="cost-row-amount">¬•200</span></div>
    <div class="cost-row"><span>Â§©ÈæçÂØ∫ Â∫≠ÂúíÔºÜÊ≥ïÂ†Ç</span><span class="cost-row-amount">¬•1,000</span></div>
    <div class="cost-row"><span>Â±±Èô∞Êú¨Á∑öÔºàÂµêÂ±±‚ÜíÊ¢ÖÂ∞èË∑ØÔºâ</span><span class="cost-row-amount">¬•200</span></div>
    <div class="cost-row"><span>Â±±Èô∞Êú¨Á∑öÔºàÊ¢ÖÂ∞èË∑Ø‚Üí‰∫¨ÈÉΩÔºâ</span><span class="cost-row-amount">¬•150</span></div>
    <div class="cost-day-sub"><span>Day 3 Â∞èË®à</span><span id="modalSub3">‚Äî</span></div>
    <div class="cost-total"><span class="cost-total-label">ÂêàË®àÔºàÊ¶ÇÁÆóÔºâ</span><span class="cost-total-amount" id="totalCost">‚Äî</span></div>
    <div class="cost-note">‚Äª Êñ∞ÂππÁ∑ö‰ª£„ÉªÂÆøÊ≥ä‰ª£„ÉªÈ£ü„ÅπÊ≠©„Åç„Éª„ÅäÂúüÁî£‰ª£„ÅØÂê´„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì</div>
    <button class="modal-close-bottom" id="costModalCloseBottom">Èñâ„Åò„Çã</button>
  </div>
</div>

<!-- QR Modal -->
<div class="modal-overlay" id="qrModal">
  <div class="modal">
    <div class="modal-title"><span>üì± QR„Ç≥„Éº„Éâ„ÅßÂÖ±Êúâ</span><button class="modal-close" id="qrModalClose">&times;</button></div>
    <div class="qr-modal-content">
      <canvas id="qrCanvas" width="200" height="200" style="border-radius:8px"></canvas>
      <div class="qr-url" id="qrUrl"></div>
      <button class="qr-copy-btn" id="qrCopyBtn">URL„Çí„Ç≥„Éî„Éº</button>
    </div>
    <button class="modal-close-bottom" id="qrModalCloseBottom">Èñâ„Åò„Çã</button>
  </div>
</div>

<!-- Help Modal -->
<div class="modal-overlay" id="helpModal">
  <div class="modal" style="max-width:580px;max-height:85vh">
    <div class="modal-title help-modal-header"><span>‚ùì ‰Ωø„ÅÑÊñπ„Ç¨„Ç§„Éâ</span><button class="modal-close" id="helpModalClose">&times;</button></div>
    <div class="help-modal-body">

      <h2>ÊóÖË°å„Çø„Ç§„É†„É©„Ç§„É≥</h2>
      <p>„Åó„Åä„Çä„ÅÆ‰∏≠ÂøÉ„Å®„Å™„ÇãÊ©üËÉΩ„Åß„Åô„ÄÇDay 1„ÄúDay 3 „ÅÆÂÖ®„Çπ„Ç±„Ç∏„É•„Éº„É´„ÅåÊôÇÁ≥ªÂàó„Åß‰∏¶„Çì„Åß„ÅÑ„Åæ„Åô„ÄÇ</p>
      <ul>
        <li>Âá∫Áô∫ÊôÇÂàª„ÉªÂà∞ÁùÄÊôÇÂàª„ÄÅ‰πóËªä„Åô„ÇãË∑ØÁ∑öÂêç„ÇÑ„Éõ„Éº„É†Áï™Âè∑</li>
        <li>ÊãùË¶≥Êñô„Éª‰∫§ÈÄöË≤ª„Å™„Å©„ÅÆË≤ªÁî®</li>
        <li><strong>üìç MAP</strong> „Åß Google „Éû„ÉÉ„Éó„ÇíÈñã„Åè</li>
        <li><strong>üîó ÂÖ¨Âºè</strong> „ÅßÂÖ¨Âºè„Çµ„Ç§„Éà„ÇíÈñã„Åè</li>
      </ul>
      <p>„Ç´„Éº„Éâ„ÅØ <strong style="color:var(--transport)">ÁßªÂãï</strong>„Éª<strong style="color:var(--sight)">Ë¶≥ÂÖâ</strong>„Éª<strong style="color:var(--food)">È£ü‰∫ã</strong>„Éª<strong style="color:var(--hotel)">ÂÆøÊ≥ä</strong> „Åß„Ç´„ÉÜ„Ç¥„É™Ëâ≤ÂàÜ„Åë„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Ç´„Éº„ÉâÈñì„ÅÆÁßªÂãïÊôÇÈñì„ÅÆÁõÆÂÆâ„ÇÇË°®Á§∫„Åï„Çå„Åæ„Åô„ÄÇ</p>
      <h3>üó∫ Day„Åî„Å®„ÅÆ„É´„Éº„ÉàË°®Á§∫</h3>
      <p>ÂêÑÊó•„ÅÆÊóÖÁ®ã„ÅÆÊú´Â∞æ„Å´„ÅÇ„Çã„Äå<strong>üó∫ Day X „ÅÆ„É´„Éº„Éà„ÇíMaps„ÅßË¶ã„Çã</strong>„Äç„É™„É≥„ÇØ„Çí„Çø„ÉÉ„Éó„Åô„Çã„Å®„ÄÅ„Åù„ÅÆÊó•„ÅÆÂÖ®„Çπ„Éù„ÉÉ„Éà„ÇíÁµåÁî±Âú∞„Å®„Åó„Åü„É´„Éº„Éà„Çí Google „Éû„ÉÉ„Éó„ÅßË°®Á§∫„Åó„Åæ„Åô„ÄÇÁßªÂãïÈ†Ü„ÇÑÊâÄË¶ÅÊôÇÈñì„ÇíÂú∞Âõ≥‰∏ä„ÅßÁ¢∫Ë™ç„Åß„Åç„ÄÅÂΩìÊó•„ÅÆ„Éä„Éì„Å®„Åó„Å¶„ÇÇÊ¥ªÁî®„Åß„Åç„Åæ„Åô„ÄÇ</p>

      <h2>‰∏äÈÉ®„Éä„Éì„Éê„Éº</h2>
      <table class="help-table">
        <tr><th>„Éú„Çø„É≥</th><th>Ê©üËÉΩ</th></tr>
        <tr><td>Day 1 / 2 / 3</td><td>„Åù„ÅÆÊó•„ÅÆÊóÖÁ®ã„Åæ„Åß„Çπ„ÇØ„É≠„Éº„É´</td></tr>
        <tr><td>üì§</td><td>„Åó„Åä„Çä„ÅÆURL„ÇíÂÖ±Êúâ</td></tr>
        <tr><td>üì±</td><td>QR„Ç≥„Éº„Éâ„ÅßÂÖ±Êúâ / URL„Ç≥„Éî„Éº</td></tr>
        <tr><td>üí∞</td><td>3Êó•Èñì„ÅÆË≤ªÁî®Ê¶ÇÁÆó„Çí‰∏ÄË¶ßË°®Á§∫</td></tr>
        <tr><td>üåô</td><td>„ÉÄ„Éº„ÇØ„É¢„Éº„ÉâÂàáÊõø</td></tr>
        <tr><td>?</td><td>„Åì„ÅÆ„Ç¨„Ç§„Éâ„ÇíË°®Á§∫</td></tr>
      </table>

      <h2>ÊóÖË°åÂΩìÊó•„ÅÆËá™ÂãïÊ©üËÉΩ</h2>
      <h3>üìç NOW „Éè„Ç§„É©„Ç§„Éà</h3>
      <p>ÊóÖË°åÂΩìÊó•Ôºà3/14„Äú16Ôºâ„Å´„Åó„Åä„Çä„ÇíÈñã„Åè„Å®„ÄÅ‰ªä„ÅÆÊôÇÂàª„Å´ÊúÄ„ÇÇËøë„ÅÑ‰∫àÂÆö„ÅåËá™Âãï„Éè„Ç§„É©„Ç§„Éà„Åï„Çå„Åæ„Åô„ÄÇ1ÂàÜ„Åî„Å®„Å´Êõ¥Êñ∞„Åï„Çå„Åæ„Åô„ÄÇ</p>
      <h3>Ëá™Âãï„Çπ„ÇØ„É≠„Éº„É´</h3>
      <p>ÊóÖË°åÂΩìÊó•„ÅØË©≤ÂΩì„Åô„ÇãÊó•„ÅÆÊóÖÁ®ã„Åæ„ÅßËá™Âãï„Çπ„ÇØ„É≠„Éº„É´„Åó„Åæ„Åô„ÄÇ</p>
      <h3>ÈÄ≤Êçó„Éê„Éº</h3>
      <p>ÊóÖË°å‰∏≠„ÅØ„Éä„Éì„Éê„Éº‰∏ã„Å´ÈÄ≤Êçó„Éê„Éº„ÅåË°®Á§∫„Åï„Çå„ÄÅ‰Ωï„Çπ„Éù„ÉÉ„ÉàÈÄöÈÅé„Åó„Åü„ÅãÁ¢∫Ë™ç„Åß„Åç„Åæ„Åô„ÄÇ</p>

      <h2>„Ç´„Ç¶„É≥„Éà„ÉÄ„Ç¶„É≥</h2>
      <p>ÊóÖË°åÂâç„ÅØ„Äå„ÅÇ„Å®‚óØÊó•„Äç„ÄÅÊóÖË°å‰∏≠„ÅØ„ÄåÊóÖË°å‰∏≠„Åß„ÅôÔºÅ„Äç„ÄÅÊóÖË°åÂæå„ÅØ„Äå„ÅäÁñ≤„Çå„Åï„Åæ„Åß„Åó„Åü„Äç„Å®Ë°®Á§∫„Åï„Çå„Åæ„Åô„ÄÇ</p>

      <h2>Â§©Ê∞ó‰∫àÂ†±</h2>
      <p>‰∫¨ÈÉΩ„ÅÆÂ§©Ê∞ó„ÇíËá™ÂãïÂèñÂæó„Åó„Åæ„ÅôÔºàË¶Å„Éç„ÉÉ„ÉàÊé•Á∂öÔºâ„ÄÇÊóÖË°å„ÅåËøë„Å•„Åè„Å®3Êó•Èñì„ÅÆ‰∫àÂ†±„ÇíË°®Á§∫„ÄÇ„Åæ„Å†ÂÖà„ÅÆÂ†¥Âêà„ÅØ‰ªä„ÅÆÂ§©Ê∞ó„Å®3Êúà‰∏≠Êó¨„ÅÆÂπ≥Âπ¥ÂÄ§„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇ</p>

      <h2>ÊåÅ„Å°Áâ©„ÉÅ„Çß„ÉÉ„ÇØ„É™„Çπ„Éà</h2>
      <ul>
        <li>„Çø„ÉÉ„Éó„Åß„ÉÅ„Çß„ÉÉ„ÇØ ON / OFF</li>
        <li>‰∏ã„ÅÆÂÖ•ÂäõÊ¨Ñ„Åã„ÇâÈ†ÖÁõÆ„ÇíËá™Áî±„Å´ËøΩÂä†ÂèØËÉΩ</li>
        <li>ÈÄ≤Êçó„Éê„Éº„ÅßÊ∫ñÂÇô„ÅÆÂÆå‰∫ÜÂ∫¶„Åå„Çè„Åã„Çä„Åæ„Åô</li>
      </ul>

      <h2>„ÅäÂúüÁî£„ÉÅ„Çß„ÉÉ„ÇØ„É™„Çπ„Éà</h2>
      <p>Ë≥ºÂÖ•Â†¥ÊâÄ„ÉªÊ∏°„ÅôÁõ∏Êâã„Åî„Å®„Å´Êï¥ÁêÜ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇË≥ºÂÖ•„Åó„Åü„Çâ„Çø„ÉÉ„Éó„Åß„ÉÅ„Çß„ÉÉ„ÇØ„ÄÇ</p>

      <h2>„É°„É¢</h2>
      <p>„ÄåÂÖ±ÈÄö„Äç„ÄåDay 1„Äç„ÄåDay 2„Äç„ÄåDay 3„Äç„ÅÆ4„Çø„Éñ„Å´ÂàÜ„Åã„Çå„Åü„É°„É¢Ê¨Ñ„Åß„Åô„ÄÇÂÖ•Âäõ„Åô„Çã„Å®Ëá™Âãï‰øùÂ≠ò„Åï„Çå„Åæ„Åô„ÄÇ</p>

      <h2>ÊóÖ„ÅÆÊÄù„ÅÑÂá∫„Ç¢„É´„Éê„É†</h2>
      <p>ÂÜôÁúü„ÇíÊúÄÂ§ß6Êûö„Åæ„Åß‰øùÂ≠ò„Åß„Åç„Åæ„Åô„ÄÇÁ©∫„Åç„Çπ„É≠„ÉÉ„Éà„Çí„Çø„ÉÉ„Éó„Åó„Å¶ÂÜôÁúü„ÇíÈÅ∏Êäû„ÄÇÂÜôÁúü„ÅÆ„Äå‚úï„Äç„Éú„Çø„É≥„ÅßÂâäÈô§„Åß„Åç„Åæ„Åô„ÄÇ</p>

      <h2>ÈßÖÊßãÂÜÖÂõ≥ / „Çπ„Éù„ÉÉ„ÉàÊâÄÂú®Âú∞</h2>
      <p>‰∏ªË¶ÅÈßÖ„ÅÆÂÖ¨ÂºèÊßãÂÜÖÂõ≥„É™„É≥„ÇØ„Å®„ÄÅ„Éõ„ÉÜ„É´„ÉªË¶≥ÂÖâÂú∞„ÅÆ„Ç¢„ÇØ„Çª„ÇπÊÉÖÂ†±„Çí„Åæ„Å®„ÇÅ„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Éõ„ÉÜ„É´„ÅÆÈõªË©±Áï™Âè∑„ÅØ„Çø„ÉÉ„Éó„ÅßÁô∫‰ø°„Åß„Åç„Åæ„Åô„ÄÇ</p>

      <h2>„Åù„ÅÆ‰ªñ</h2>
      <ul>
        <li><strong>‚Üë „Éú„Çø„É≥</strong> ‚Äî ÁîªÈù¢Âè≥‰∏ã„Å´Ë°®Á§∫„ÄÇ„Çø„ÉÉ„Éó„Åß„Éö„Éº„Ç∏ÂÖàÈ†≠„Å∏</li>
        <li><strong>Âç∞Âà∑</strong> ‚Äî Ctrl+P / ‚åò+P „ÅßÊóÖÁ®ã„Å†„Åë„ÅÆ„Ç∑„É≥„Éó„É´„Å™„Åó„Åä„Çä„ÇíÂç∞Âà∑</li>
        <li><strong>„Éõ„Éº„É†ÁîªÈù¢„Å´ËøΩÂä†</strong>ÔºàiPhoneÔºâ‚Äî Safari„ÅÆÂÖ±Êúâ„É°„Éã„É•„Éº„Åã„ÇâËøΩÂä†„Åô„Çã„Å®„Ç¢„Éó„É™È¢®„Å´‰Ωø„Åà„Åæ„Åô</li>
        <li><strong>Esc „Ç≠„Éº</strong> ‚Äî „É¢„Éº„ÉÄ„É´ÁîªÈù¢„ÇíÈñâ„Åò„Åæ„Åô</li>
      </ul>

      <hr>

      <div class="help-note">
        üíæ <strong>„Éá„Éº„Çø„ÅÆ‰øùÂ≠ò„Å´„Å§„ÅÑ„Å¶</strong><br>
        „ÉÅ„Çß„ÉÉ„ÇØ„É™„Çπ„Éà„Éª„É°„É¢„ÉªÂÜôÁúü„Éª„ÉÜ„Éº„ÉûË®≠ÂÆö„ÅØ„Éñ„É©„Ç¶„Ç∂„Å´Ëá™Âãï‰øùÂ≠ò„Åï„Çå„ÄÅ„Éö„Éº„Ç∏„ÇíÈñâ„Åò„Å¶„ÇÇÊ∂à„Åà„Åæ„Åõ„Çì„ÄÇ<br><br>
        ‚ö†Ô∏è „Éñ„É©„Ç¶„Ç∂„ÅÆÈñ≤Ë¶ß„Éá„Éº„ÇøÔºà„Ç≠„É£„ÉÉ„Ç∑„É•Á≠âÔºâ„ÇíÂâäÈô§„Åô„Çã„Å®‰øùÂ≠ò„Éá„Éº„Çø„ÇÇÊ∂à„Åà„Åæ„Åô„ÄÇÂà•„ÅÆÁ´ØÊú´„Éª„Éñ„É©„Ç¶„Ç∂„Åã„Çâ„ÅØÂºï„ÅçÁ∂ô„Åå„Çå„Åæ„Åõ„Çì„ÄÇ
      </div>

    </div>
    <button class="modal-close-bottom" id="helpModalCloseBottom">Èñâ„Åò„Çã</button>
  </div>
</div>

<!-- Back to top -->
<button class="back-to-top" id="backToTop">‚Üë</button>

<script>
// ===== Utility: Checklist save/load =====
function saveChecklist(storageKey, items) {
  const state = {};
  items.forEach(function(c) { if (c.classList.contains('checked')) state[c.dataset.key] = true; });
  try { localStorage.setItem(storageKey, JSON.stringify(state)); } catch(e) { console.warn('localStorage unavailable'); }
}
function loadChecklist(storageKey, items) {
  try {
    const s = JSON.parse(localStorage.getItem(storageKey) || '{}');
    items.forEach(function(i) { if (s[i.dataset.key]) i.classList.add('checked'); });
  } catch(e) {}
}

// ===== Intersection Observer for timeline =====
const observer = new IntersectionObserver(function(entries) {
  entries.forEach(function(e) { if (e.isIntersecting) e.target.classList.add('visible'); });
}, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });
document.querySelectorAll('.timeline-item').forEach(function(e, i) {
  e.style.transitionDelay = ((i % 6) * 0.06) + 's';
  observer.observe(e);
});

// ===== Sticky nav scroll shadow =====
const nav = document.getElementById('dayNav');
window.addEventListener('scroll', function() { nav.classList.toggle('scrolled', window.scrollY > 100); });

// ===== Day nav buttons =====
const navBtns = document.querySelectorAll('.nav-day-btn');
navBtns.forEach(function(btn) {
  btn.addEventListener('click', function() {
    const id = btn.dataset.target;
    document.getElementById(id).scrollIntoView({ behavior: 'smooth', block: 'start' });
  });
});
const dayObs = new IntersectionObserver(function(entries) {
  entries.forEach(function(e) {
    if (e.isIntersecting) {
      const id = e.target.id;
      navBtns.forEach(function(b) { b.classList.remove('active'); });
      const match = document.querySelector('[data-target="' + id + '"]');
      if (match) match.classList.add('active');
    }
  });
}, { threshold: 0.2 });
document.querySelectorAll('[id^="day"]').forEach(function(s) { dayObs.observe(s); });

// ===== Nav brand click => scroll to top =====
document.getElementById('navBrand').addEventListener('click', function() {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

// ===== Theme toggle =====
function toggleTheme() {
  const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
  document.documentElement.setAttribute('data-theme', isDark ? '' : 'dark');
  document.getElementById('themeBtn').textContent = isDark ? 'üåô' : '‚òÄÔ∏è';
  try { localStorage.setItem('theme', isDark ? 'light' : 'dark'); } catch(e) {}
}
document.getElementById('themeBtn').addEventListener('click', toggleTheme);
try { if (localStorage.getItem('theme') === 'dark') { document.documentElement.setAttribute('data-theme', 'dark'); document.getElementById('themeBtn').textContent = '‚òÄÔ∏è'; } } catch(e) {}

// ===== Cost Modal =====
function toggleCostModal() { document.getElementById('costModal').classList.toggle('open'); }
document.getElementById('costBtn').addEventListener('click', toggleCostModal);
document.getElementById('costModalClose').addEventListener('click', toggleCostModal);
document.getElementById('costModalCloseBottom').addEventListener('click', toggleCostModal);
document.getElementById('costModal').addEventListener('click', function(e) { if (e.target === e.currentTarget) toggleCostModal(); });

// ===== QR Modal =====
function toggleQrModal() { document.getElementById('qrModal').classList.toggle('open'); }
document.getElementById('qrBtn').addEventListener('click', function() {
  toggleQrModal();
  generateQR();
});
document.getElementById('qrModalClose').addEventListener('click', toggleQrModal);
document.getElementById('qrModalCloseBottom').addEventListener('click', toggleQrModal);
document.getElementById('qrModal').addEventListener('click', function(e) { if (e.target === e.currentTarget) toggleQrModal(); });

// Simple QR code generation using Canvas (basic encoding)
function generateQR() {
  const url = window.location.href;
  document.getElementById('qrUrl').textContent = url;
  const canvas = document.getElementById('qrCanvas');
  const ctx = canvas.getContext('2d');
  // Use a simple API to display QR - fallback to URL display
  const img = new Image();
  img.crossOrigin = 'anonymous';
  img.onload = function() {
    ctx.clearRect(0, 0, 200, 200);
    ctx.drawImage(img, 0, 0, 200, 200);
  };
  img.onerror = function() {
    ctx.clearRect(0, 0, 200, 200);
    ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--ink-faint');
    ctx.font = '13px sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('QR„Ç≥„Éº„Éâ„ÇíÁîüÊàê„Åß„Åç„Åæ„Åõ„Çì', 100, 90);
    ctx.fillText('‰∏ã„ÅÆURL„Çí„Ç≥„Éî„Éº„Åó„Å¶„Åè„Å†„Åï„ÅÑ', 100, 110);
  };
  img.src = 'https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=' + encodeURIComponent(url);
}

document.getElementById('qrCopyBtn').addEventListener('click', function() {
  navigator.clipboard.writeText(window.location.href).then(function() {
    const btn = document.getElementById('qrCopyBtn');
    btn.textContent = '„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü ‚úì';
    setTimeout(function() { btn.textContent = 'URL„Çí„Ç≥„Éî„Éº'; }, 1500);
  });
});

// ===== Share button (Web Share API) =====
document.getElementById('shareBtn').addEventListener('click', function() {
  if (navigator.share) {
    navigator.share({
      title: '‰∫¨ÈÉΩÊóÖË°å„ÅÆ„Åó„Åä„Çä 2026.3.14-3.16',
      text: 'Êù±Á¶èÂØ∫„ÉªÂÆáÊ≤ª„Éª‰ºèË¶ãÁ®≤Ëç∑„ÉªÈáëÈñ£ÂØ∫„ÉªÈäÄÈñ£ÂØ∫„ÉªÊ∏ÖÊ∞¥ÂØ∫„ÉªÂµêÂ±±„Çí„ÇÅ„Åê„Çã2Ê≥ä3Êó•„ÅÆÊóÖÁ®ã',
      url: window.location.href
    }).catch(function() {});
  } else {
    navigator.clipboard.writeText(window.location.href).then(function() {
      const btn = document.getElementById('shareBtn');
      btn.textContent = '‚úì';
      setTimeout(function() { btn.textContent = 'üì§'; }, 1500);
    });
  }
});

// ===== Help Modal =====
function toggleHelpModal() { document.getElementById('helpModal').classList.toggle('open'); }
document.getElementById('helpBtn').addEventListener('click', toggleHelpModal);
document.getElementById('helpModalClose').addEventListener('click', toggleHelpModal);
document.getElementById('helpModalCloseBottom').addEventListener('click', toggleHelpModal);
document.getElementById('helpModal').addEventListener('click', function(e) { if (e.target === e.currentTarget) toggleHelpModal(); });

// ===== Escape key closes modals =====
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    document.getElementById('costModal').classList.remove('open');
    document.getElementById('qrModal').classList.remove('open');
    document.getElementById('helpModal').classList.remove('open');
  }
});

// ===== Cost calculation =====
function calcCosts() {
  const titles = document.querySelectorAll('.cost-day-title');
  let grand = 0;
  titles.forEach(function(t, i) {
    let sub = 0;
    let el = t.nextElementSibling;
    while (el && !el.classList.contains('cost-day-title') && !el.classList.contains('cost-total')) {
      if (el.classList.contains('cost-row')) {
        const a = el.querySelector('.cost-row-amount');
        if (a) {
          const val = parseInt(a.textContent.replace(/[¬•,\s]/g, ''));
          if (!isNaN(val)) sub += val;
        }
      }
      el = el.nextElementSibling;
    }
    grand += sub;
    const ms = document.getElementById('modalSub' + (i + 1));
    if (ms) ms.textContent = '¬•' + sub.toLocaleString();
    const ts = document.getElementById('sub' + (i + 1));
    if (ts) ts.textContent = '¬•' + sub.toLocaleString();
  });
  document.getElementById('totalCost').textContent = '¬•' + grand.toLocaleString();
}
calcCosts();

// ===== Packing checklist =====
const checkItems = document.querySelectorAll('.check-item');
const pFill = document.getElementById('progressFill');
const pText = document.getElementById('progressText');

function updateProgress() {
  const all = document.querySelectorAll('.check-item');
  const t = all.length;
  const d = document.querySelectorAll('.check-item.checked').length;
  pFill.style.width = ((d / t) * 100) + '%';
  pText.textContent = d + '/' + t;
}

function bindCheckItem(item) {
  item.addEventListener('click', function() {
    item.classList.toggle('checked');
    saveChecklist('kyoto-checks', document.querySelectorAll('.check-item'));
    updateProgress();
  });
}
checkItems.forEach(bindCheckItem);
loadChecklist('kyoto-checks', checkItems);
updateProgress();

// ===== Add custom checklist item =====
const addCheckInput = document.getElementById('addCheckInput');
const addCheckBtn = document.getElementById('addCheckBtn');
let customCheckCount = 0;

function loadCustomItems() {
  try {
    const customs = JSON.parse(localStorage.getItem('kyoto-checks-custom') || '[]');
    customs.forEach(function(name) { addCustomCheckItem(name, false); });
  } catch(e) {}
}

function addCustomCheckItem(name, save) {
  customCheckCount++;
  const key = 'custom' + customCheckCount;
  const label = document.createElement('label');
  label.className = 'check-item';
  label.dataset.key = key;
  label.innerHTML = '<span class="check-box">‚úì</span>' + name;
  document.getElementById('checklist').appendChild(label);
  bindCheckItem(label);
  if (save) {
    try {
      const customs = JSON.parse(localStorage.getItem('kyoto-checks-custom') || '[]');
      customs.push(name);
      localStorage.setItem('kyoto-checks-custom', JSON.stringify(customs));
    } catch(e) {}
  }
  loadChecklist('kyoto-checks', document.querySelectorAll('.check-item'));
  updateProgress();
}

loadCustomItems();

addCheckBtn.addEventListener('click', function() {
  const val = addCheckInput.value.trim();
  if (val) { addCustomCheckItem(val, true); addCheckInput.value = ''; }
});
addCheckInput.addEventListener('keydown', function(e) {
  if (e.key === 'Enter') { e.preventDefault(); addCheckBtn.click(); }
});

// ===== Memo with tabs =====
const memoArea = document.getElementById('memoArea');
const memoSaved = document.getElementById('memoSaved');
const memoTabs = document.querySelectorAll('.memo-tab');
let currentMemoKey = 'kyoto-memo-general';
let memoTimer;

function loadMemo() {
  try { memoArea.value = localStorage.getItem(currentMemoKey) || ''; } catch(e) {}
}

memoTabs.forEach(function(tab) {
  tab.addEventListener('click', function() {
    memoTabs.forEach(function(t) { t.classList.remove('active'); });
    tab.classList.add('active');
    currentMemoKey = 'kyoto-memo-' + tab.dataset.memo;
    loadMemo();
  });
});

loadMemo();

memoArea.addEventListener('input', function() {
  clearTimeout(memoTimer);
  memoTimer = setTimeout(function() {
    try { localStorage.setItem(currentMemoKey, memoArea.value); } catch(e) {}
    memoSaved.classList.add('show');
    setTimeout(function() { memoSaved.classList.remove('show'); }, 1500);
  }, 600);
});

// ===== Omiyage checklist =====
const omiyageItems = document.querySelectorAll('.omiyage-check');
const oPFill = document.getElementById('omiyageProgressFill');
const oPText = document.getElementById('omiyageProgressText');

function updateOmiyageProgress() {
  const t = omiyageItems.length;
  const d = document.querySelectorAll('.omiyage-check.checked').length;
  oPFill.style.width = ((d / t) * 100) + '%';
  oPText.textContent = d + '/' + t;
}

omiyageItems.forEach(function(item) {
  item.addEventListener('click', function() {
    item.classList.toggle('checked');
    saveChecklist('kyoto-omiyage', omiyageItems);
    updateOmiyageProgress();
  });
});
loadChecklist('kyoto-omiyage', omiyageItems);
updateOmiyageProgress();

// ===== NOW highlight =====
function highlightNow() {
  const now = new Date();
  const today = now.toISOString().split('T')[0];
  const nowM = now.getHours() * 60 + now.getMinutes();
  document.querySelectorAll('.timeline-item.now-here').forEach(function(e) { e.classList.remove('now-here'); });
  const tl = document.querySelector('.timeline[data-day="' + today + '"]');
  if (!tl) return;
  const items = tl.querySelectorAll('.timeline-item[data-time]');
  let closest = null, closestD = Infinity;
  items.forEach(function(item) {
    const p = item.dataset.time.split(':');
    const h = parseInt(p[0]), m = parseInt(p[1]);
    const d = nowM - (h * 60 + m);
    if (d >= 0 && d < closestD) { closestD = d; closest = item; }
  });
  if (closest) closest.classList.add('now-here');
}
highlightNow();
setInterval(highlightNow, 60000);

// ===== Auto-scroll to current day on trip dates =====
(function autoScrollToday() {
  const now = new Date();
  const today = now.toISOString().split('T')[0];
  const dates = { '2026-03-14': 'day1', '2026-03-15': 'day2', '2026-03-16': 'day3' };
  if (dates[today]) {
    setTimeout(function() {
      document.getElementById(dates[today]).scrollIntoView({ behavior: 'smooth', block: 'start' });
    }, 1200);
  }
})();

// ===== Travel progress bar =====
function updateTravelProgress() {
  const tripStart = new Date(2026, 2, 14, 6, 57);
  const tripEnd = new Date(2026, 2, 16, 17, 49);
  const now = new Date();
  const progressEl = document.getElementById('travelProgress');
  const fillEl = document.getElementById('travelProgressFill');
  const pctEl = document.getElementById('travelProgressPct');
  const textEl = document.getElementById('travelProgressText');
  if (now >= tripStart && now <= tripEnd) {
    progressEl.classList.add('active');
    const total = tripEnd - tripStart;
    const elapsed = now - tripStart;
    const pct = Math.min(100, Math.round((elapsed / total) * 100));
    fillEl.style.width = pct + '%';
    pctEl.textContent = pct + '%';
    // Count completed items
    const allItems = document.querySelectorAll('.timeline-item[data-time]');
    let completed = 0;
    allItems.forEach(function(item) {
      const tl = item.closest('.timeline');
      const day = tl ? tl.dataset.day : '';
      const parts = item.dataset.time.split(':');
      const itemDate = new Date(day + 'T' + parts[0].padStart(2, '0') + ':' + parts[1].padStart(2, '0') + ':00');
      if (now >= itemDate) completed++;
    });
    textEl.textContent = completed + '/' + allItems.length + ' „Çπ„Éù„ÉÉ„Éà';
  } else {
    progressEl.classList.remove('active');
  }
}
updateTravelProgress();
setInterval(updateTravelProgress, 60000);

// ===== Sakura petals (stops after 30s to save battery) =====
let sakuraActive = true;
function createPetal() {
  if (!sakuraActive) return;
  const c = document.getElementById('sakuraContainer');
  const p = document.createElement('div');
  p.className = 'sakura-petal';
  const l = Math.random() * 100;
  const dur = 6 + Math.random() * 8;
  const sz = 10 + Math.random() * 12;
  const sw = 20 + Math.random() * 40;
  const rot = 180 + Math.random() * 360;
  const del = Math.random() * 2;
  p.style.cssText = 'left:' + l + '%;animation-duration:' + dur + 's;animation-delay:' + del + 's;--petal-size:' + sz + 'px;--sway:' + sw + 'px;--rotation:' + rot + 'deg';
  c.appendChild(p);
  setTimeout(function() { p.remove(); }, (dur + del) * 1000 + 500);
}
function sakuraLoop() {
  if (!sakuraActive) return;
  createPetal();
  setTimeout(sakuraLoop, 800 + Math.random() * 2000);
}
sakuraLoop();
setTimeout(function() { sakuraActive = false; }, 30000);

// ===== Countdown =====
function updateCountdown() {
  const tripStart = new Date(2026, 2, 14, 0, 0, 0);
  const tripEnd = new Date(2026, 2, 16, 23, 59, 59);
  const now = new Date();
  const display = document.getElementById('countdownDisplay');
  const sub = document.getElementById('countdownSub');
  const title = document.querySelector('.countdown-title');
  if (now > tripEnd) {
    title.textContent = '‰∫¨ÈÉΩÊóÖË°å 2026';
    display.textContent = 'Á¥†Êïµ„Å™ÊóÖ„Åß„Åó„Åü üå∏';
    sub.textContent = '';
  } else if (now >= tripStart) {
    title.textContent = 'üå∏ ‰∫¨ÈÉΩÊóÖË°å';
    display.textContent = 'ÊóÖË°å‰∏≠ÔºÅÊ•Ω„Åó„Çì„ÅßÔºÅ';
    sub.textContent = '';
  } else {
    const todayM = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    const tripM = new Date(2026, 2, 14);
    const diff = Math.ceil((tripM - todayM) / 86400000);
    display.textContent = '„ÅÇ„Å® ' + diff + ' Êó•';
    sub.textContent = '3Êúà14Êó•ÔºàÂúüÔºâÂá∫Áô∫';
  }
}
updateCountdown();

// ===== Weather (Open-Meteo) with caching =====
async function fetchWeather() {
  const container = document.getElementById('weatherDays');
  const note = document.getElementById('weatherNote');
  const currentSection = document.getElementById('weatherCurrent');
  const currentBody = document.getElementById('weatherCurrentBody');
  const historySection = document.getElementById('weatherHistory');
  const dates = ['2026-03-14', '2026-03-15', '2026-03-16'];
  const dayLabels = ['3/14ÔºàÂúüÔºâ', '3/15ÔºàÊó•Ôºâ', '3/16ÔºàÊúàÔºâ'];
  let forecastFound = false;

  // Check cache (1 hour)
  const cacheKey = 'kyoto-weather-cache';
  let cached = null;
  try {
    cached = JSON.parse(localStorage.getItem(cacheKey));
    if (cached && (Date.now() - cached.ts < 3600000)) {
      renderForecast(cached.data);
      return;
    }
  } catch(e) {}

  try {
    const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=35.0116&longitude=135.7681&daily=weather_code,temperature_2m_max,temperature_2m_min,precipitation_probability_max,wind_speed_10m_max&timezone=Asia%2FTokyo&forecast_days=16');
    if (!res.ok) throw new Error('API error');
    const data = await res.json();
    try { localStorage.setItem(cacheKey, JSON.stringify({ ts: Date.now(), data: data })); } catch(e) {}
    renderForecast(data);
  } catch(e) {
    console.warn('Weather fetch error:', e);
    renderNoForecast();
  }

  function renderForecast(data) {
    const d = data.daily;
    let html = '';
    dates.forEach(function(date, idx) {
      const i = d.time.indexOf(date);
      if (i !== -1) {
        forecastFound = true;
        const code = d.weather_code[i];
        const icon = weatherIcon(code);
        const hi = Math.round(d.temperature_2m_max[i]);
        const lo = Math.round(d.temperature_2m_min[i]);
        const rain = d.precipitation_probability_max[i];
        const wind = Math.round(d.wind_speed_10m_max[i]);
        html += '<div class="weather-day"><div class="weather-day-label">' + dayLabels[idx] + '</div><div class="weather-day-icon">' + icon + '</div><div class="weather-day-temp">' + hi + '¬∞ <span class="weather-day-temp-min">/ ' + lo + '¬∞</span></div><div class="weather-day-detail">‚òî ' + rain + '%„ÄÄüí® ' + wind + 'km/h</div></div>';
      }
    });
    if (forecastFound) {
      container.innerHTML = html;
      note.textContent = 'Open-MeteoÊèê‰æõ ¬∑ Ëá™ÂãïÊõ¥Êñ∞';
    } else {
      renderNoForecast();
    }
  }

  async function renderNoForecast() {
    container.innerHTML = '<div class="weather-error" style="font-size:.8rem;color:var(--ink-faint);text-align:center;padding:.5rem">ÊóÖË°åÊó•„ÅÆ‰∫àÂ†±„ÅØ„Åæ„Å†ÈÖç‰ø°„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„ÇìÔºàÁ¥Ñ2ÈÄ±ÈñìÂâç„Åã„ÇâËá™ÂãïË°®Á§∫Ôºâ</div>';
    note.textContent = '';
    historySection.style.display = 'block';
    try {
      const cres = await fetch('https://api.open-meteo.com/v1/forecast?latitude=35.0116&longitude=135.7681&current=temperature_2m,weather_code,relative_humidity_2m,wind_speed_10m&timezone=Asia%2FTokyo');
      if (cres.ok) {
        const cdata = await cres.json();
        const cur = cdata.current;
        const cIcon = weatherIcon(cur.weather_code);
        const cDesc = weatherDesc(cur.weather_code);
        const cTemp = Math.round(cur.temperature_2m);
        const cHum = cur.relative_humidity_2m;
        const cWind = Math.round(cur.wind_speed_10m);
        currentBody.innerHTML = '<div class="weather-current-icon">' + cIcon + '</div><div class="weather-current-temp">' + cTemp + '‚ÑÉ</div><div class="weather-current-detail">' + cDesc + '<br>üíß ÊπøÂ∫¶ ' + cHum + '%„ÄÄüí® ' + cWind + 'km/h</div>';
        currentSection.style.display = 'block';
        note.textContent = 'Open-MeteoÊèê‰æõ ¬∑ „É™„Ç¢„É´„Çø„Ç§„É†Êõ¥Êñ∞';
      }
    } catch(e2) { console.warn('Current weather fetch error:', e2); }
  }
}

function weatherIcon(code) {
  if (code === 0) return '‚òÄÔ∏è'; if (code <= 3) return '‚õÖ'; if (code <= 48) return '‚òÅÔ∏è';
  if (code <= 57) return 'üå¶'; if (code <= 67) return 'üåß'; if (code <= 77) return 'üå®';
  if (code <= 82) return 'üåß'; if (code <= 86) return '‚ùÑÔ∏è'; if (code <= 99) return '‚õà'; return 'üå§';
}
function weatherDesc(code) {
  if (code === 0) return 'Âø´Êô¥'; if (code <= 3) return 'Êô¥„ÇåÊôÇ„ÄÖÊõá„Çä'; if (code <= 48) return 'Êõá„Çä';
  if (code <= 57) return 'ÈúßÈõ®'; if (code <= 67) return 'Èõ®'; if (code <= 77) return '„Åø„Åû„Çå/Èõ™';
  if (code <= 82) return '„Å´„Çè„ÅãÈõ®'; if (code <= 86) return 'Èõ™'; if (code <= 99) return 'Èõ∑Èõ®'; return 'Êô¥„Çå';
}
fetchWeather();

// ===== Back to top button =====
const backToTop = document.getElementById('backToTop');
window.addEventListener('scroll', function() {
  backToTop.classList.toggle('visible', window.scrollY > 600);
});
backToTop.addEventListener('click', function() {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

// ===== Photo Album =====
const albumGrid = document.getElementById('albumGrid');
albumGrid.addEventListener('click', function(e) {
  const slot = e.target.closest('.album-slot');
  if (!slot) return;
  // If clicking remove button
  if (e.target.classList.contains('album-remove')) {
    e.stopPropagation();
    const idx = slot.dataset.slot;
    slot.innerHTML = '<span class="album-slot-icon">üì∑</span><span class="album-slot-text">„Çø„ÉÉ„Éó„ÅßËøΩÂä†</span><input type="file" accept="image/*">';
    try { localStorage.removeItem('kyoto-album-' + idx); } catch(e) {}
    return;
  }
  // If no image yet, trigger file input
  const fileInput = slot.querySelector('input[type="file"]');
  if (fileInput) fileInput.click();
});

albumGrid.addEventListener('change', function(e) {
  if (e.target.type !== 'file') return;
  const file = e.target.files[0];
  if (!file) return;
  const slot = e.target.closest('.album-slot');
  const idx = slot.dataset.slot;
  const reader = new FileReader();
  reader.onload = function(ev) {
    const dataUrl = ev.target.result;
    slot.innerHTML = '<img src="' + dataUrl + '" alt="ÊóÖ„ÅÆÂÜôÁúü"><button class="album-remove">‚úï</button><input type="file" accept="image/*">';
    try { localStorage.setItem('kyoto-album-' + idx, dataUrl); } catch(e) { console.warn('Photo too large for localStorage'); }
  };
  reader.readAsDataURL(file);
});

// Load saved album photos
document.querySelectorAll('.album-slot').forEach(function(slot) {
  const idx = slot.dataset.slot;
  try {
    const saved = localStorage.getItem('kyoto-album-' + idx);
    if (saved) {
      slot.innerHTML = '<img src="' + saved + '" alt="ÊóÖ„ÅÆÂÜôÁúü"><button class="album-remove">‚úï</button><input type="file" accept="image/*">';
    }
  } catch(e) {}
});
</script>
<!-- Story Mode Overlay -->
<div class="story-overlay" id="storyOverlay">
  <div class="story-progress-bar" id="storyProgressBar"></div>
  <button class="story-close" id="storyClose">‚úï</button>
  <div class="story-paused-indicator">‚ùö‚ùö</div>
  <div class="story-slide-container" id="storySlideContainer"></div>
  <div class="story-touch" id="storyTouch">
    <div class="story-touch-left"></div>
    <div class="story-touch-center"></div>
    <div class="story-touch-right"></div>
  </div>
</div>

<script>
// ===== Story Mode =====
(function() {
  var overlay = document.getElementById('storyOverlay');
  var container = document.getElementById('storySlideContainer');
  var progressBar = document.getElementById('storyProgressBar');
  var touch = document.getElementById('storyTouch');
  var currentSlide = 0;
  var slides = [];
  var timer = null;
  var isPaused = false;
  var DURATION_OPENING = 5000;
  var DURATION_ROUTE = 5500;
  var DURATION_DAYBREAK = 3000;
  var DURATION_SPOT = 4500;
  var DURATION_ENDING = 7000;

  // Read review data from localStorage (written by card review UI)
  function getReview(name) {
    try {
      var key = 'kyoto-review-' + name;
      var data = localStorage.getItem(key);
      if (data) return JSON.parse(data);
    } catch(e) {}
    return { stars: 0, comment: '' };
  }
  // Read user photo from localStorage
  function getUserPhoto(name) {
    try {
      return localStorage.getItem('kyoto-photo-' + name) || '';
    } catch(e) { return ''; }
  }

  function extractSpots() {
    var allSlides = [];
    var allSpotPhotos = []; // {img, stars, name} for all spots

    var days = [
      { id: 'day1', num: 'Day 1', date: '3/14', weekday: 'ÂúüÊõúÊó•' },
      { id: 'day2', num: 'Day 2', date: '3/15', weekday: 'Êó•ÊõúÊó•' },
      { id: 'day3', num: 'Day 3', date: '3/16', weekday: 'ÊúàÊõúÊó•' }
    ];

    var dayData = []; // { spots: [], bestImg: '' }

    days.forEach(function(day) {
      var dd = { spots: [], bestImg: '', bestStars: -1 };
      var section = document.getElementById(day.id);
      if (!section) { dayData.push(dd); return; }
      var items = section.querySelectorAll('.timeline-item');
      items.forEach(function(item) {
        var card = item.querySelector('.timeline-card');
        if (!card) return;
        var isSight = card.classList.contains('sight');
        var isFood = card.classList.contains('food');
        if (!isSight && !isFood) return;
        var title = card.querySelector('.card-title');
        if (!title) return;
        var name = title.textContent.trim();
        var time = item.querySelector('.timeline-time');
        var timeText = time ? time.textContent.trim() : '';
        var userPhoto = getUserPhoto(name);
        var img = card.querySelector('.card-photo');
        var imgSrc = userPhoto || (img ? img.src : '');
        var placeholder = card.querySelector('.card-photo-placeholder');
        var emoji = placeholder ? placeholder.textContent.trim() : '';
        var cat = isSight ? 'sight' : 'food';
        var catLabel = isSight ? 'Ë¶≥ÂÖâ' : 'È£ü‰∫ã';
        var review = getReview(name);
        var spotData = {
          type: 'spot', name: name,
          time: day.num + ' ¬∑ ' + timeText,
          img: imgSrc, emoji: emoji,
          category: cat, categoryLabel: catLabel,
          stars: review.stars, comment: review.comment,
          duration: DURATION_SPOT
        };
        dd.spots.push(spotData);
        if (imgSrc) {
          allSpotPhotos.push({ img: imgSrc, stars: review.stars, name: name });
          if (review.stars > dd.bestStars || (review.stars === dd.bestStars && userPhoto)) {
            dd.bestStars = review.stars;
            dd.bestImg = imgSrc;
          }
        }
      });
      // fallback: if no best by review, use first available photo
      if (!dd.bestImg) {
        for (var k = 0; k < dd.spots.length; k++) {
          if (dd.spots[k].img) { dd.bestImg = dd.spots[k].img; break; }
        }
      }
      dayData.push(dd);
    });

    // Find overall best photo (highest starred, prefer user photos)
    var overallBest = '';
    var overallBestStars = -1;
    allSpotPhotos.forEach(function(p) {
      if (p.stars > overallBestStars) { overallBestStars = p.stars; overallBest = p.img; }
    });
    if (!overallBest && allSpotPhotos.length) overallBest = allSpotPhotos[0].img;

    // Try to find a transport/travel photo for route slide
    var routePhoto = getUserPhoto('__travel_route__') || '';
    // Also check transport cards for any user photo
    if (!routePhoto) {
      var transportNames = [];
      document.querySelectorAll('.timeline-card.transport .card-title').forEach(function(t) { transportNames.push(t.textContent.trim()); });
      for (var tn = 0; tn < transportNames.length; tn++) {
        var tp = getUserPhoto(transportNames[tn]);
        if (tp) { routePhoto = tp; break; }
      }
    }

    // Build final slide array
    allSlides.push({ type: 'opening', duration: DURATION_OPENING, bgImg: overallBest });
    allSlides.push({ type: 'route', duration: DURATION_ROUTE, bgImg: routePhoto });

    days.forEach(function(day, idx) {
      allSlides.push({ type: 'daybreak', num: day.num, date: day.date, weekday: day.weekday, duration: DURATION_DAYBREAK, bgImg: dayData[idx].bestImg });
      dayData[idx].spots.forEach(function(s) { allSlides.push(s); });
    });

    allSlides.push({ type: 'ending', duration: DURATION_ENDING, bgImg: overallBest });
    return allSlides;
  }

  function starsHTML(n) {
    var s = '';
    for (var i = 0; i < 5; i++) {
      s += '<span class="story-spot-star">' + (i < n ? '‚òÖ' : '‚òÜ') + '</span>';
    }
    return s;
  }

  function buildSlide(data, index) {
    var div = document.createElement('div');
    div.className = 'story-slide';
    div.dataset.index = index;

    if (data.type === 'opening') {
      div.classList.add('story-opening');
      var bgHTML = data.bgImg ? '<div class="story-spot-img-wrap"><img class="story-spot-img" src="' + data.bgImg + '" alt="" onload="this.classList.add(\'loaded\')" style="filter:brightness(.6)"><div class="story-spot-gradient" style="background:radial-gradient(ellipse at 50% 50%,rgba(10,9,8,.25),rgba(10,9,8,.6))"></div></div>' : '';
      var petals = '<div class="story-opening-petals">';
      for (var i = 0; i < 8; i++) {
        var left = Math.random() * 100;
        var delay = Math.random() * 3;
        var dur = 3 + Math.random() * 2;
        petals += '<div class="story-opening-petal" style="left:' + left + '%;animation-delay:' + delay + 's;animation-duration:' + dur + 's">üå∏</div>';
      }
      petals += '</div>';
      div.innerHTML = bgHTML + petals +
        '<div style="position:relative;z-index:1">' +
        '<div class="story-opening-label">My Travel Journal</div>' +
        '<div class="story-opening-title">‰∫¨ÈÉΩ</div>' +
        '<div class="story-opening-line"></div>' +
        '<div class="story-opening-dates">2026.3.14 ‚Äî 3.16</div>' +
        '<div class="story-opening-meta">2Ê≥ä3Êó•„ÅÆÊóÖ</div>' +
        '</div>';
    }
    else if (data.type === 'route') {
      div.classList.add('story-route');
      var routeBg = data.bgImg ? '<div class="story-spot-img-wrap"><img class="story-spot-img" src="' + data.bgImg + '" alt="" onload="this.classList.add(\'loaded\')" style="filter:brightness(.5) saturate(.75)"><div class="story-spot-gradient" style="background:rgba(10,9,8,.35)"></div></div>' : '';
      div.innerHTML = routeBg +
        '<div style="position:relative;z-index:1;display:flex;flex-direction:column;align-items:center;justify-content:center;flex:1">' +
        '<div class="story-route-title">travel route</div>' +
        '<svg viewBox="0 0 300 200" fill="none" xmlns="http://www.w3.org/2000/svg">' +
        '<defs><linearGradient id="rg" x1="0" y1="0" x2="1" y2="0"><stop offset="0%" stop-color="#F2A7B3"/><stop offset="100%" stop-color="#C4A265"/></linearGradient></defs>' +
        '<!-- Japan outline hint -->' +
        '<ellipse cx="150" cy="100" rx="130" ry="75" fill="none" stroke="rgba(255,255,255,.05)" stroke-width="1"/>' +
        '<!-- Route -->' +
        '<path id="routePath" d="M 195 72 Q 190 78 178 82 Q 150 95 110 108 Q 85 118 68 128" stroke="url(#rg)" stroke-width="2.5" stroke-linecap="round" fill="none" stroke-dasharray="300" stroke-dashoffset="300"><animate attributeName="stroke-dashoffset" from="300" to="0" dur="2s" begin="0.5s" fill="freeze"/></path>' +
        '<!-- Dots -->' +
        '<g opacity="0"><circle cx="195" cy="72" r="4" fill="#F2A7B3"/><animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="0.3s" fill="freeze"/></g>' +
        '<g opacity="0"><circle cx="178" cy="82" r="3.5" fill="#D4748A"/><animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="1.2s" fill="freeze"/></g>' +
        '<g opacity="0"><circle cx="68" cy="128" r="5" fill="#C4A265"/><animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="2.3s" fill="freeze"/></g>' +
        '<!-- Labels -->' +
        '<g opacity="0" font-family="Zen Kaku Gothic New,sans-serif"><text x="195" y="64" fill="rgba(255,255,255,.6)" font-size="9" text-anchor="middle">ÁÜäË∞∑</text><animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="0.3s" fill="freeze"/></g>' +
        '<g opacity="0" font-family="Zen Kaku Gothic New,sans-serif"><text x="178" y="75" fill="rgba(255,255,255,.6)" font-size="9" text-anchor="middle">Êù±‰∫¨</text><animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="1.2s" fill="freeze"/></g>' +
        '<g opacity="0" font-family="Zen Old Mincho,serif"><text x="68" y="148" fill="#FBF8F5" font-size="14" text-anchor="middle" font-weight="700">‰∫¨ÈÉΩ</text><animate attributeName="opacity" from="0" to="1" dur="0.4s" begin="2.3s" fill="freeze"/></g>' +
        '<!-- Train icon -->' +
        '<g opacity="0"><text x="135" y="93" font-size="14">üöÖ</text>' +
        '<animateMotion path="M60,-15 Q-25,5 -65,22" dur="1.8s" begin="0.6s" fill="freeze"/>' +
        '<animate attributeName="opacity" values="0;1;1;1" keyTimes="0;0.05;0.9;1" dur="1.8s" begin="0.6s" fill="freeze"/></g>' +
        '</svg>' +
        '<div class="story-route-stats">' +
        '<div class="story-route-stat"><div class="story-route-stat-num">9</div><div class="story-route-stat-label">„Çπ„Éù„ÉÉ„Éà</div></div>' +
        '<div class="story-route-stat"><div class="story-route-stat-num">2Ê≥ä3Êó•</div><div class="story-route-stat-label">ÊóÖÁ®ã</div></div>' +
        '</div></div>';
    }
    else if (data.type === 'daybreak') {
      div.classList.add('story-daybreak');
      var dayBg = data.bgImg ? '<div class="story-spot-img-wrap"><img class="story-spot-img" src="' + data.bgImg + '" alt="" onload="this.classList.add(\'loaded\')" style="filter:brightness(.5) saturate(.8)"><div class="story-spot-gradient" style="background:radial-gradient(ellipse at 50% 50%,rgba(10,9,8,.3),rgba(10,9,8,.6))"></div></div>' : '';
      div.innerHTML = dayBg +
        '<div style="position:relative;z-index:1">' +
        '<div class="story-daybreak-num">' + data.num + '</div>' +
        '<div class="story-daybreak-date">' + data.date + '</div>' +
        '<div class="story-daybreak-weekday">' + data.weekday + '</div>' +
        '</div>';
    }
    else if (data.type === 'spot') {
      div.classList.add('story-spot');
      var imgHTML = '';
      if (data.img) {
        imgHTML = '<div class="story-spot-img-wrap">' +
          '<img class="story-spot-img-bg" src="' + data.img + '" alt="">' +
          '<img class="story-spot-img" src="' + data.img + '" alt="" onload="this.classList.add(\'loaded\')">' +
          '<div class="story-spot-gradient"></div></div>';
      } else {
        imgHTML = '<div class="story-spot-img-wrap" style="background:#1a1614;display:flex;align-items:center;justify-content:center"><span style="font-size:5rem;opacity:.15">' + (data.emoji || 'üìç') + '</span><div class="story-spot-gradient"></div></div>';
      }
      var starsStr = data.stars > 0 ? '<div class="story-spot-stars">' + starsHTML(data.stars) + '</div>' : '';
      var commentStr = data.comment ? '<div class="story-spot-comment">' + data.comment + '</div>' : '';
      div.innerHTML = imgHTML +
        '<div class="story-spot-content">' +
        '<div class="story-spot-category ' + data.category + '">' + data.categoryLabel + '</div>' +
        '<div class="story-spot-name">' + data.name + '</div>' +
        '<div class="story-spot-time">' + data.time + '</div>' +
        starsStr +
        commentStr +
        '</div>';
    }
    else if (data.type === 'ending') {
      div.classList.add('story-ending');
      var endBg = data.bgImg ? '<div class="story-spot-img-wrap"><img class="story-spot-img" src="' + data.bgImg + '" alt="" onload="this.classList.add(\'loaded\')" style="filter:brightness(.5) saturate(.7)"><div class="story-spot-gradient" style="background:radial-gradient(ellipse at 50% 50%,rgba(10,9,8,.3),rgba(10,9,8,.65))"></div></div>' : '';
      // Find best spot
      var bestName = '';
      var bestStars = 0;
      slides.forEach(function(s) {
        if (s.type === 'spot' && s.stars >= bestStars) {
          bestStars = s.stars;
          bestName = s.name;
        }
      });
      if (!bestName) bestName = '‚Äî';
      // Calculate average rating
      var totalStars = 0, ratedCount = 0;
      slides.forEach(function(s) { if (s.type === 'spot' && s.stars > 0) { totalStars += s.stars; ratedCount++; } });
      var avgStars = ratedCount > 0 ? (totalStars / ratedCount).toFixed(1) : '‚Äî';
      var spotCount = slides.filter(function(s) { return s.type === 'spot'; }).length;
      div.innerHTML = endBg +
        '<div style="position:relative;z-index:1">' +
        '<div class="story-ending-stats">' +
        '<div><div class="story-ending-stat-num">' + spotCount + '</div><div class="story-ending-stat-label">„Çπ„Éù„ÉÉ„Éà</div></div>' +
        '<div><div class="story-ending-stat-num">2Ê≥ä3Êó•</div><div class="story-ending-stat-label">ÊóÖ Á®ã</div></div>' +
        '<div><div class="story-ending-stat-num">¬•10,130</div><div class="story-ending-stat-label">Ë¶≥ÂÖâË≤ªÁî®</div></div>' +
        '<div><div class="story-ending-stat-num">‚òÖ ' + avgStars + '</div><div class="story-ending-stat-label">Âπ≥ÂùáË©ï‰æ°</div></div>' +
        '</div>' +
        '<div class="story-ending-best">' +
        '<div class="story-ending-best-label">BEST SPOT</div>' +
        '<div class="story-ending-best-name">' + bestName + '</div>' +
        '<div class="story-ending-best-stars">' + starsHTML(bestStars) + '</div>' +
        '</div>' +
        '<div class="story-ending-title">‰∫¨ÈÉΩ 2026</div>' +
        '<div class="story-ending-sub">ËâØ„ÅÑÊóÖ„Åß„Åó„Åü</div>' +
        '<div class="story-ending-petal">üå∏</div>' +
        '</div>';
    }
    return div;
  }

  function buildStory() {
    slides = extractSpots();
    container.innerHTML = '';
    progressBar.innerHTML = '';
    slides.forEach(function(data, i) {
      var slide = buildSlide(data, i);
      container.appendChild(slide);
      var seg = document.createElement('div');
      seg.className = 'story-progress-seg';
      seg.innerHTML = '<div class="story-progress-fill"></div>';
      progressBar.appendChild(seg);
    });
  }

  function goTo(index) {
    if (index < 0 || index >= slides.length) {
      closeStory();
      return;
    }
    clearTimeout(timer);
    var allSlides = container.querySelectorAll('.story-slide');
    var allFills = progressBar.querySelectorAll('.story-progress-fill');
    var prev = currentSlide;
    currentSlide = index;

    allSlides.forEach(function(s, i) {
      s.className = 'story-slide';
      if (i === index) s.classList.add('active');
      else if (i === prev && prev < index) s.classList.add('exit-left');
      else if (i === prev && prev > index) s.classList.add('enter-right');
    });

    allFills.forEach(function(f, i) {
      f.classList.remove('active', 'done');
      f.style.width = '';
      f.style.transitionDuration = '';
      if (i < index) {
        f.classList.add('done');
        f.style.width = '100%';
      } else if (i === index) {
        f.classList.add('active');
        var dur = slides[i].duration;
        // Force reflow
        void f.offsetWidth;
        f.style.transitionDuration = dur + 'ms';
        f.style.width = '100%';
      } else {
        f.style.width = '0';
      }
    });

    // Auto-advance
    if (!isPaused) {
      timer = setTimeout(function() {
        goTo(currentSlide + 1);
      }, slides[currentSlide].duration);
    }
  }

  function openStory() {
    buildStory();
    currentSlide = 0;
    isPaused = false;
    overlay.classList.add('active');
    overlay.classList.remove('paused');
    document.body.style.overflow = 'hidden';
    goTo(0);
  }

  function closeStory() {
    clearTimeout(timer);
    overlay.classList.remove('active', 'paused');
    document.body.style.overflow = '';
  }

  // Controls ‚Äî time-locked until 2026-03-16 15:00 JST
  var STORY_UNLOCK = new Date('2026-03-16T15:00:00+09:00').getTime();
  var storyBtnEl = document.getElementById('storyBtn');

  function isStoryUnlocked() {
    return Date.now() >= STORY_UNLOCK;
  }
  function updateStoryLock() {
    if (isStoryUnlocked()) {
      storyBtnEl.classList.remove('locked');
      storyBtnEl.title = '„Çπ„Éà„Éº„É™„Éº„É¢„Éº„Éâ';
    } else {
      storyBtnEl.classList.add('locked');
      storyBtnEl.title = '3/16 15:00 „Å´Ëß£Êîæ';
    }
  }
  updateStoryLock();
  // Re-check every minute
  setInterval(updateStoryLock, 60000);

  function showToast(msg) {
    var t = document.getElementById('storyToast');
    if (!t) {
      t = document.createElement('div');
      t.className = 'story-toast';
      t.id = 'storyToast';
      document.body.appendChild(t);
    }
    t.textContent = msg;
    t.classList.remove('show');
    void t.offsetWidth;
    t.classList.add('show');
    setTimeout(function() { t.classList.remove('show'); }, 2800);
  }

  storyBtnEl.addEventListener('click', function() {
    if (!isStoryUnlocked()) {
      // Calculate remaining time
      var diff = STORY_UNLOCK - Date.now();
      var days = Math.floor(diff / 86400000);
      var hrs = Math.floor((diff % 86400000) / 3600000);
      var mins = Math.floor((diff % 3600000) / 60000);
      var timeStr = '';
      if (days > 0) timeStr = days + 'Êó•' + hrs + 'ÊôÇÈñì';
      else if (hrs > 0) timeStr = hrs + 'ÊôÇÈñì' + mins + 'ÂàÜ';
      else timeStr = mins + 'ÂàÜ';
      showToast('üîí „Çπ„Éà„Éº„É™„Éº„ÅØ 3/16 15:00 „Å´Ëß£ÊîæÔºà„ÅÇ„Å®' + timeStr + 'Ôºâ');
      return;
    }
    openStory();
  });
  document.getElementById('storyClose').addEventListener('click', function(e) {
    e.stopPropagation();
    closeStory();
  });

  // Touch / Click
  touch.addEventListener('click', function(e) {
    var rect = touch.getBoundingClientRect();
    var x = (e.clientX - rect.left) / rect.width;
    if (x < 0.3) {
      goTo(currentSlide - 1);
    } else if (x > 0.7) {
      goTo(currentSlide + 1);
    }
  });

  // Long press to pause
  var pressTimer = null;
  touch.addEventListener('touchstart', function(e) {
    pressTimer = setTimeout(function() {
      isPaused = true;
      overlay.classList.add('paused');
      clearTimeout(timer);
    }, 200);
  }, { passive: true });
  touch.addEventListener('touchend', function() {
    clearTimeout(pressTimer);
    if (isPaused) {
      isPaused = false;
      overlay.classList.remove('paused');
      timer = setTimeout(function() {
        goTo(currentSlide + 1);
      }, Math.max(1000, slides[currentSlide].duration / 2));
    }
  });
  touch.addEventListener('touchmove', function() {
    clearTimeout(pressTimer);
  }, { passive: true });

  // Keyboard
  document.addEventListener('keydown', function(e) {
    if (!overlay.classList.contains('active')) return;
    if (e.key === 'Escape') closeStory();
    if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); goTo(currentSlide + 1); }
    if (e.key === 'ArrowLeft') { e.preventDefault(); goTo(currentSlide - 1); }
  });
})();
</script>

<script>
// ===== Card Reviews & Photo Upload =====
(function() {
  var SAVE_DELAY = 600;
  var MAX_PHOTO_W = 1200;
  var JPEG_QUALITY = 0.72;

  // Find all sight & food cards
  var cards = document.querySelectorAll('.timeline-card.sight, .timeline-card.food');

  cards.forEach(function(card) {
    var titleEl = card.querySelector('.card-title');
    if (!titleEl) return;
    var spotName = titleEl.textContent.trim();

    // === 1. Inject Review UI ===
    var reviewEl = document.createElement('div');
    reviewEl.className = 'card-review';

    var row = document.createElement('div');
    row.className = 'card-review-row';

    var label = document.createElement('span');
    label.className = 'card-review-label';
    label.textContent = 'ÊóÖ„ÅÆÊÑüÊÉ≥';

    var starsWrap = document.createElement('div');
    starsWrap.className = 'card-review-stars';

    var savedMsg = document.createElement('span');
    savedMsg.className = 'card-review-saved';
    savedMsg.textContent = '‚úì ‰øùÂ≠ò';

    var currentStars = 0;

    for (var i = 1; i <= 5; i++) {
      (function(starNum) {
        var star = document.createElement('button');
        star.className = 'card-review-star';
        star.type = 'button';
        star.textContent = '‚òÜ';
        star.setAttribute('aria-label', starNum + 'Êòü');
        star.addEventListener('click', function() {
          // Toggle: if same star tapped again, clear
          if (currentStars === starNum) {
            currentStars = 0;
          } else {
            currentStars = starNum;
          }
          updateStarDisplay();
          saveReview();
        });
        starsWrap.appendChild(star);
      })(i);
    }

    var commentInput = document.createElement('input');
    commentInput.type = 'text';
    commentInput.className = 'card-review-input';
    commentInput.placeholder = '„Å≤„Å®„Åì„Å®ÊÑüÊÉ≥„ÇíÊõ∏„Åè‚Ä¶';
    commentInput.maxLength = 60;
    var commentTimer = null;
    commentInput.addEventListener('input', function() {
      clearTimeout(commentTimer);
      commentTimer = setTimeout(saveReview, SAVE_DELAY);
    });
    commentInput.addEventListener('blur', saveReview);

    row.appendChild(label);
    row.appendChild(starsWrap);
    row.appendChild(savedMsg);
    reviewEl.appendChild(row);
    reviewEl.appendChild(commentInput);

    // Insert before card-bottom
    var bottom = card.querySelector('.card-bottom');
    if (bottom) card.insertBefore(reviewEl, bottom);
    else card.appendChild(reviewEl);

    function updateStarDisplay() {
      var stars = starsWrap.querySelectorAll('.card-review-star');
      stars.forEach(function(s, idx) {
        if (idx < currentStars) {
          s.textContent = '‚òÖ';
          s.classList.add('filled');
        } else {
          s.textContent = '‚òÜ';
          s.classList.remove('filled');
        }
      });
    }

    function flashSaved() {
      savedMsg.classList.add('show');
      setTimeout(function() { savedMsg.classList.remove('show'); }, 1500);
    }

    function saveReview() {
      var data = { stars: currentStars, comment: commentInput.value.trim() };
      try {
        localStorage.setItem('kyoto-review-' + spotName, JSON.stringify(data));
        flashSaved();
      } catch(e) { console.warn('Review save error:', e); }
    }

    // Load existing review
    try {
      var saved = localStorage.getItem('kyoto-review-' + spotName);
      if (saved) {
        var d = JSON.parse(saved);
        currentStars = d.stars || 0;
        commentInput.value = d.comment || '';
        updateStarDisplay();
      }
    } catch(e) {}

    // === 2. Photo Upload ===
    var photoWrap = card.querySelector('.card-photo-wrap');

    if (photoWrap) {
      // Cards WITH existing photo area ‚Äî add camera button overlay
      addPhotoOverlay(photoWrap, spotName);
    } else {
      // Cards WITHOUT photo area (some food cards) ‚Äî add mini slot
      addMiniPhotoSlot(card, spotName, bottom);
    }
  });

  function resizeAndStore(file, key, callback) {
    var reader = new FileReader();
    reader.onload = function(e) {
      var img = new Image();
      img.onload = function() {
        var w = img.width, h = img.height;
        if (w > MAX_PHOTO_W) {
          h = Math.round(h * MAX_PHOTO_W / w);
          w = MAX_PHOTO_W;
        }
        var canvas = document.createElement('canvas');
        canvas.width = w;
        canvas.height = h;
        var ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0, w, h);
        var dataUrl = canvas.toDataURL('image/jpeg', JPEG_QUALITY);
        try {
          localStorage.setItem('kyoto-photo-' + key, dataUrl);
        } catch(e) {
          console.warn('Photo too large for storage');
        }
        callback(dataUrl);
      };
      img.src = e.target.result;
    };
    reader.readAsDataURL(file);
  }

  function addPhotoOverlay(wrap, spotName) {
    // Camera add button
    var addBtn = document.createElement('button');
    addBtn.className = 'card-photo-add';
    addBtn.type = 'button';
    addBtn.innerHTML = 'üì∑';
    var fileInput = document.createElement('input');
    fileInput.type = 'file';
    fileInput.accept = 'image/*';
    addBtn.appendChild(fileInput);

    // Remove button
    var removeBtn = document.createElement('button');
    removeBtn.className = 'card-photo-remove';
    removeBtn.type = 'button';
    removeBtn.textContent = '‚úï';

    wrap.appendChild(addBtn);
    wrap.appendChild(removeBtn);

    addBtn.addEventListener('click', function(e) {
      e.stopPropagation();
      fileInput.click();
    });

    fileInput.addEventListener('change', function() {
      if (!fileInput.files[0]) return;
      resizeAndStore(fileInput.files[0], spotName, function(dataUrl) {
        showUserPhoto(wrap, dataUrl, removeBtn);
      });
      fileInput.value = '';
    });

    removeBtn.addEventListener('click', function(e) {
      e.stopPropagation();
      removeUserPhoto(wrap, spotName, removeBtn);
    });

    // Load saved photo
    try {
      var saved = localStorage.getItem('kyoto-photo-' + spotName);
      if (saved) showUserPhoto(wrap, saved, removeBtn);
    } catch(e) {}
  }

  function showUserPhoto(wrap, src, removeBtn) {
    var existing = wrap.querySelector('.card-photo-user');
    if (existing) existing.remove();
    var img = document.createElement('img');
    img.className = 'card-photo-user';
    img.src = src;
    img.alt = 'Ëá™ÂàÜ„ÅÆÂÜôÁúü';
    wrap.appendChild(img);
    removeBtn.classList.add('has-photo');
  }

  function removeUserPhoto(wrap, spotName, removeBtn) {
    var userImg = wrap.querySelector('.card-photo-user');
    if (userImg) userImg.remove();
    removeBtn.classList.remove('has-photo');
    try { localStorage.removeItem('kyoto-photo-' + spotName); } catch(e) {}
  }

  function addMiniPhotoSlot(card, spotName, insertBefore) {
    var slot = document.createElement('div');
    slot.className = 'card-photo-mini';
    slot.innerHTML = '<span class="card-photo-mini-icon">üì∑</span><span class="card-photo-mini-text">ÂÜôÁúü„ÇíËøΩÂä†</span>';
    var fileInput = document.createElement('input');
    fileInput.type = 'file';
    fileInput.accept = 'image/*';
    slot.appendChild(fileInput);

    var removeBtn = document.createElement('button');
    removeBtn.className = 'card-photo-remove';
    removeBtn.type = 'button';
    removeBtn.textContent = '‚úï';
    slot.appendChild(removeBtn);

    if (insertBefore) card.insertBefore(slot, insertBefore);
    else card.appendChild(slot);

    slot.addEventListener('click', function(e) {
      if (e.target === removeBtn) return;
      if (!slot.querySelector('img')) fileInput.click();
    });

    fileInput.addEventListener('change', function() {
      if (!fileInput.files[0]) return;
      resizeAndStore(fileInput.files[0], spotName, function(dataUrl) {
        var existing = slot.querySelector('img');
        if (existing) existing.remove();
        var img = document.createElement('img');
        img.src = dataUrl;
        img.alt = 'Ëá™ÂàÜ„ÅÆÂÜôÁúü';
        slot.appendChild(img);
        removeBtn.classList.add('has-photo');
        slot.querySelector('.card-photo-mini-icon').style.display = 'none';
        slot.querySelector('.card-photo-mini-text').style.display = 'none';
      });
      fileInput.value = '';
    });

    removeBtn.addEventListener('click', function(e) {
      e.stopPropagation();
      var img = slot.querySelector('img');
      if (img) img.remove();
      removeBtn.classList.remove('has-photo');
      slot.querySelector('.card-photo-mini-icon').style.display = '';
      slot.querySelector('.card-photo-mini-text').style.display = '';
      try { localStorage.removeItem('kyoto-photo-' + spotName); } catch(e2) {}
    });

    // Load saved
    try {
      var saved = localStorage.getItem('kyoto-photo-' + spotName);
      if (saved) {
        var img = document.createElement('img');
        img.src = saved;
        img.alt = 'Ëá™ÂàÜ„ÅÆÂÜôÁúü';
        slot.appendChild(img);
        removeBtn.classList.add('has-photo');
        slot.querySelector('.card-photo-mini-icon').style.display = 'none';
        slot.querySelector('.card-photo-mini-text').style.display = 'none';
      }
    } catch(e) {}
  }

  // Also add photo slots to specific transport cards only
  var transportPhotoNames = ['Êù±‰∫¨ÈßÖÂá∫Áô∫', '‰∫¨ÈÉΩÈßÖÁùÄ', '‰∫¨ÈÉΩÈßÖÂá∫Áô∫'];
  var transportCards = document.querySelectorAll('.timeline-card.transport');
  transportCards.forEach(function(card) {
    var titleEl = card.querySelector('.card-title');
    if (!titleEl) return;
    var spotName = titleEl.textContent.trim();
    if (transportPhotoNames.indexOf(spotName) === -1) return;
    // Exclude the Kumagaya-bound Êù±‰∫¨ÈßÖÂá∫Áô∫ („ÅÇ„Åï„Åæ)
    var detail = card.querySelector('.card-detail');
    if (spotName === 'Êù±‰∫¨ÈßÖÂá∫Áô∫' && detail && detail.textContent.indexOf('„ÅÇ„Åï„Åæ') !== -1) return;
    var bottom = card.querySelector('.card-bottom');
    addMiniPhotoSlot(card, spotName, bottom);
  });
})();
</script>
</body>
</html>
